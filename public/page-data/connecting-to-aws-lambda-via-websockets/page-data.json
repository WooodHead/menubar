{"componentChunkName":"component---src-components-post-tsx","path":"/connecting-to-aws-lambda-via-websockets","result":{"pageContext":{"post":{"id":"cjkq4u7470ihr0157ad175b12","title":"Connecting to AWS Lambda via WebSockets","slug":"connecting-to-aws-lambda-via-websockets","published_at":"2020-01-12T05:00:00","created_at":"2018-08-12T00:50:12","encoded_html":"PHA+QVdTIExhbWJkYSBpcyB1c3VhbGx5IHVzZWQgZm9yIHNob3J0LWxpdmVkIHByb2Nlc3NlcyBsaWtlIHRoZSByZXF1ZXN0L3Jlc3BvbnNlIGxpZmVjeWNsZS4gVGhlIGRlZmF1bHQgTGFtYmRhIHRpbWVvdXQgb2YgMyBzZWNvbmRzIHJlZmxlY3RzIHRoaXMgY29tbW9uIHVzZS1jYXNlLjwvcD4KPGltZyBzcmM9Imh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9jb250ZW50a2l0L3N0YXRpYy9jamtxNHU3NDcwaWhyMDE1N2FkMTc1YjEyL2F3cy1sYW1iZGEtbGltaXRzLnBuZyIgLz4KPHA+SG93ZXZlciB0aGUgbWF4aW11bSBleGVjdXRpb24gZHVyYXRpb24gb2YgQVdTIExhbWJkYSBmdW5jdGlvbnMgd2FzIGluY3JlYXNlZCBmcm9tIDEgbWludXRlIHRvIDUgbWludXRlcyBhIGZldyB5ZWFycyBhZ28uIDwvcD4KPHA+Tm90IG9ubHkgaXMgaXQgcG9zc2libGUgdG8gY29ubmVjdCB0byBBV1MgTGFtYmRhIHZpYSBXZWJTb2NrZXRzIHVzaW5nIE1RVFQgb3IgQVdTIElvVERhdGEgYnV0IHRoaXMgc3RyYXRlZ3kgd29ya3Mgc3VycHJpc2luZ2x5IHdlbGwuPC9wPgo8cD5NUVRUIGlzIGJvdGggYSBnZW5lcmFsIHB1Ymxpc2gtc3Vic2NyaWJlIG1lc3NhZ2luZyBwcm90b2NvbCBhbmQgYSBwb3B1bGFyIG5wbSBwYWNrYWdlLiBNUVRUICh0aGUgbnBtIHBhY2thZ2UpIGhhcyBhIGNsZWFuIGludGVyZmFjZSB0aGF0IGVuYWJsZXMgaW5pdGlhdGluZyBhIFdlYlNvY2tldCBjb25uZWN0aW9uLCBzdWJzY3JpYmluZyB0byB0b3BpY3MsIGxpc3RlbmluZyBmb3IgbWVzc2FnZXMsIGFuZCBwdWJsaXNoaW5nIG1lc3NhZ2VzLjwvcD4KPGgyPk92ZXJhbGwgU3RyYXRlZ3k8L2gyPgo8aW1nIHNyYz0iaHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tL2NvbnRlbnRraXQvc3RhdGljL2Nqa3E0dTc0NzBpaHIwMTU3YWQxNzViMTIvTVFUVC5qcy5wbmciIC8+CjxwPk9uIHRoZSBjbGllbnQgc2lkZSwgd2UgZmV0Y2ggYSBXZWJTb2NrZXQgdXJsIHRoYXQgZm9ybWFsbHkgbG9va3Mgc29tZXRoaW5nIGxpa2UgdGhpczo8L3A+CjxwcmU+PGNvZGU+d3NzOi8vWFhYWFguaW90LnVzLWVhc3QtMS5hbWF6b25hd3MuY29tL21xdHQ/WC1BbXotRGF0ZT0yMDE4MDgxMlQxMzMyNTlaJlgtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9WlpaJTJGMjAxODA4MTIlMkZ1cy1lYXN0LTElMkZpb3RkZXZpY2VnYXRld2F5JTJGYXdzNF9yZXF1ZXN0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZYLUFtei1TaWduYXR1cmU9UFBQJlgtQW16LVNlY3VyaXR5LVRva2VuPVFRUTwvY29kZT48L3ByZT4KPHA+VGhpcyBjYW4gYmUgZ2VuZXJhdGVkIHVzaW5nIGF3cy1zaWduLW1xdHQ6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1qcyI+PHNwYW4gY2xhc3M9InRva2VuIGNvbW1lbnQiPi8vIHNldCB0aGUgQVdTX0lPVF9IT1NUIGVudmlyb25tZW50YWwgdmFyaWFibGU6PC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gZXhwb3J0IEFXU19JT1RfSE9TVD0kKGF3cyAtLXJlZ2lvbiB1cy1lYXN0LTEgaW90IGRlc2NyaWJlLWVuZHBvaW50IC0tb3V0cHV0IHRleHQpPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+Y29uc3Q8L3NwYW4+IHVybCA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+cmVxdWlyZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J2F3cy1zaWduLW1xdHQnPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPjwvY29kZT48L3ByZT4KPHA+VGhpcyBpcyBqdXN0IGEgV2ViU29ja2V0IFVSTCBzaWduZWQgdXNpbmcgQVdTIHNpZ25hdHVyZSB2NC48L3A+CjxwPlRoaXMgV2ViU29ja2V0IFVSTCBzaG91bGQgb2J2aW91c2x5IGJlIGdlbmVyYXRlZCBzZXJ2ZXItc2lkZSAobGVzdCB5b3UgZXhwb3NlIHlvdXIgQVdTIGNyZWRlbnRpYWxzKS48L3A+CjxwPlRvIGRlbW9uc3RyYXRlIGhvdyBBV1MgTGFtYmRhIGNhbiBiZSB1c2VkIGZvciBsb25nLWxpdmVkIFdlYlNvY2tldCBjb25uZWN0aW9ucywgd2UnbGwgY3JlYXRlIHR3byBzaW1wbGUgTGFtYmRhIGZ1bmN0aW9ucy4gVGhlIGZpcnN0IGlzIGEgc2ltcGxlIEhUVFAgZW5kcG9pbnQgdGhhdCByZXR1cm5zIGEgc2lnbmVkIFdlYlNvY2tldCB1cmwuIFRoZSBzZWNvbmQgbGFtYmRhIGZ1bmN0aW9uIGlzIHRyaWdnZXJlZCB3aGVuIHRoZSBjbGllbnQgc3Vic2NyaWJlcyB0byBhbiBBV1MgSW9UIHRvcGljLiA8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWpzIj48c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+Y29uc3Q8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBjb25zdGFudCI+QVdTPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+cmVxdWlyZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J2F3cy1zZGsnPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmNvbnN0PC9zcGFuPiBjcmVhdGVQcmVzaWduZWRVUkwgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnJlcXVpcmU8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidhd3Mtc2lnbi1tcXR0Jzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5jb25zdDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPiByYW5kb21CeXRlcyA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5yZXF1aXJlPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4nY3J5cHRvJzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBjb21tZW50Ij4vLyBMYW1iZGEgZnVuY3Rpb24gIzEgLSBzZXNzaW9uPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gU2ltcGxlIEhUVFAgZW5kcG9pbnQgdGhhdCByZXR1cm5zIHRoZSBXZWJTb2NrZXQgVVJMIGFuZCBjaGFubmVsIElEPC9zcGFuPgptb2R1bGU8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+ZXhwb3J0czxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24tdmFyaWFibGUgZnVuY3Rpb24iPnNlc3Npb248L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwYXJhbWV0ZXIiPmV2ZW50PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiBjb250ZXh0PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiBjYWxsYmFjazwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PT48L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+Y29uc3Q8L3NwYW4+IGVuZHBvaW50VXJsIDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5jcmVhdGVQcmVzaWduZWRVUkw8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gY3JlYXRlIGFuIGFyYml0cmFyeSBjaGFubmVsIElEIHRvIGlkZW50aWZ5IHRoZSBjdXJyZW50IHNlc3Npb248L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmNvbnN0PC9zcGFuPiBjaGFubmVsSWQgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnJhbmRvbUJ5dGVzPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gbnVtYmVyIj41PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj50b1N0cmluZzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J2hleCc8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPiAKICA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmNhbGxiYWNrPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+bnVsbDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4KICAgIHN0YXR1c0NvZGU8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBudW1iZXIiPjIwMDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICBib2R5PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gY29uc3RhbnQiPkpTT048L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c3RyaW5naWZ5PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+IGVuZHBvaW50VXJsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiBjaGFubmVsSWQgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICBoZWFkZXJzPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+JyonPC9zcGFuPgogICAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIGNvbW1lbnQiPi8vIExhbWJkYSBmdW5jdGlvbiAjMiAtIG1xdHQ8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBjb21tZW50Ij4vLyBTZW5kcyBtZXNzYWdlcyB0byB0aGUgY2xpZW50IHZpYSBBV1MgSW90RGF0YS48L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBjb21tZW50Ij4vLyBZb3UgbXVzdCBtYW51YWxseSBzZXQgdGhlIEFXU19JT1RfSE9TVCBlbnZpcm9ubWVudGFsIHZhcmlhYmxlIHdoaWNoIGlzIGFjY291bnQtc3BlY2lmaWMuPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gRnJvbSB0aGUgY29tbWFuZCBsaW5lIHJ1bjogYXdzIGlvdCBkZXNjcmliZS1lbmRwb2ludCAtLW91dHB1dCB0ZXh0PC9zcGFuPgptb2R1bGU8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+ZXhwb3J0czxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24tdmFyaWFibGUgZnVuY3Rpb24iPm1xdHQ8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmFzeW5jPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHBhcmFtZXRlciI+cGF5bG9hZDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gY29udGV4dDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PT48L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gVGhlIHBheWxvYWQgaXMgd2hhdGV2ZXIgd2Ugc2VuZCBmcm9tIHRoZSBicm93c2VyPC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5jb25zdDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPiBjaGFubmVsSWQgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IHBheWxvYWQKICA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+Y29uc3Q8L3NwYW4+IGlvdCA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5uZXc8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBjbGFzcy1uYW1lIj5BV1M8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+SW90RGF0YTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgZW5kcG9pbnQ8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IHByb2Nlc3M8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+ZW52PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBjb25zdGFudCI+QVdTX0lPVF9IT1NUPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgIHJlZ2lvbjxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gcHJvY2VzczxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj5lbnY8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGNvbnN0YW50Ij5BV1NfUkVHSU9OPC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIGNvbW1lbnQiPi8vIHdlIHJlc3BvbmQgd2l0aCBhIGRpZmZlcmVudCB0b3BpYyB0aGF0IHVzZXMgdGhlIGNoYW5uZWxJRDwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gdG8gYXZvaWQgYnJvYWRjYXN0aW5nIHRoZSBzYW1lIG1lc3NhZ2UgdG8gYWxsIHVzZXJzPC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5hd2FpdDwvc3Bhbj4gaW90PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+cHVibGlzaDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgdG9waWM8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiB0ZW1wbGF0ZS1zdHJpbmciPjxzcGFuIGNsYXNzPSJ0b2tlbiB0ZW1wbGF0ZS1wdW5jdHVhdGlvbiBzdHJpbmciPmA8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+Zm9vYmFyLzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gaW50ZXJwb2xhdGlvbiI+PHNwYW4gY2xhc3M9InRva2VuIGludGVycG9sYXRpb24tcHVuY3R1YXRpb24gcHVuY3R1YXRpb24iPiR7PC9zcGFuPmNoYW5uZWxJZDxzcGFuIGNsYXNzPSJ0b2tlbiBpbnRlcnBvbGF0aW9uLXB1bmN0dWF0aW9uIHB1bmN0dWF0aW9uIj59PC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4vcmVzcG9uc2U8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXB1bmN0dWF0aW9uIHN0cmluZyI+YDwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgcGF5bG9hZDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGNvbnN0YW50Ij5KU09OPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnN0cmluZ2lmeTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPiBtZXNzYWdlPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4naGVsbG8nPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgIHFvczxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG51bWJlciI+MTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnByb21pc2U8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gYXQgdGhpcyBwb2ludCB0aGUgTGFtYmRhIGZ1bmN0aW9uIGVuZHMgYmVjYXVzZSB0aGUgTm9kZSBldmVudCBsb29wIGlzIGNsb3NlZDwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPgo8L2NvZGU+PC9wcmU+CjxwPkhlcmUncyB3aGF0IG91ciBzZXJ2ZXJsZXNzLnltbCBtaWdodCBsb29rIGxpa2U6PC9wPgo8cHJlPjxjb2RlPnNlcnZpY2U6IGZvb2Jhcgpwcm92aWRlcjoKICBuYW1lOiBhd3MKICBydW50aW1lOiBub2RlanM4LjEwCiAgcmVnaW9uOiB1cy1lYXN0LTEKICBlbnZpcm9ubWVudDogCiAgICBBV1NfSU9UX0hPU1Q6ICcnCiAgaWFtUm9sZVN0YXRlbWVudHM6CiAgICAtIEVmZmVjdDogIkFsbG93IgogICAgICBBY3Rpb246IAogICAgICAgIC0gaW90OioKICAgICAgUmVzb3VyY2U6ICIqIgpmdW5jdGlvbnM6CiAgc2Vzc2lvbjoKICAgIGhhbmRsZXI6IGhhbmRsZXIuc2Vzc2lvbgogICAgZXZlbnRzOgogICAgICAtIGh0dHA6CiAgICAgICAgICBtZXRob2Q6IEdFVAogICAgICAgICAgcGF0aDogLwogICAgICAgICAgY29yczogdHJ1ZSAjIGNoYW5nZSB0aGlzIGluIHByb2R1Y3Rpb24gdG8gImNyZWRlbnRhaWxzOiB0cnVlIiB0byBzZWN1cmUgZW5kcG9pbnQKICBtcXR0OgogICAgaGFuZGxlcjogaGFuZGxlci5tcXR0CiAgICBldmVudHM6IAogICAgICAtIGlvdAogICAgICAgICAgc3FsOiAnU0VMRUNUICogRlJPTSBmb29iYXIvc2Vzc2lvbicKICA8L2NvZGU+PC9wcmU+CjxwPkFmdGVyIGRlcGxveWluZyBvdXIgZnVuY3Rpb24gKHNscyBkZXBsb3kpLCBzZXJ2ZXJsZXNzIHdpbGwgcHJpbnQgdGhlIHNlc3Npb24gZW5kcG9pbnQgdGhhdCB3ZSBuZWVkIHRvIGdlbmVyYXRlIHRoZSBXZWJTb2NrZXQgVVJMOjwvcD4KPHByZT48Y29kZT5TZXJ2aWNlIEluZm9ybWF0aW9uCnNlcnZpY2U6IGZvb2JhcgpyZWdpb246IHVzLWVhc3QtMQpzdGFjazogZm9vYmFyLWRldgphcGkga2V5czoKICBOb25lCmVuZHBvaW50czoKICBHRVQgLSBodHRwczovL3h4eHh4LmV4ZWN1dGUtYXBpLnVzLWVhc3QtMS5hbWF6b25hd3MuY29tL2RldgogIEdFVCAtIGh0dHBzOi8veHh4eHguZXhlY3V0ZS1hcGkudXMtZWFzdC0xLmFtYXpvbmF3cy5jb20vZGV2CmZ1bmN0aW9uczoKICBtcXR0OiBmb29iYXItZGV2LW1xdHQKICBzZXNzaW9uOiBmb29iYXItZGV2LXNlc3Npb248L2NvZGU+PC9wcmU+CjxwPklmIHlvdSBoYXZlIHRoZSBBV1MgY29tbWFuZCBsaW5lIGludGVyZmFjZSBpbnN0YWxsZWQgeW91IGNhbiB0cnkgcnVubmluZyBzb21ldGhpbmcgbGlrZSB0aGUgZm9sbG93aW5nIGZyb20gdGVybWluYWwgdG8gdGVzdCB5b3VyIGZ1bmN0aW9uczo8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWJhc2giPmF3cyAtLXJlZ2lvbiB1cy1lYXN0LTEgaW90LWRhdGEgcHVibGlzaCAtLXRvcGljIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidmb29iYXIvc2Vzc2lvbic8L3NwYW4+IC0tcGF5bG9hZCA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4neyAiY2hhbm5lbElkIjogIjEiIH0nPC9zcGFuPjwvY29kZT48L3ByZT4KPHA+VGhlIGFib3ZlIGNvbW1hbmQgc2hvdWxkIHRyaWdnZXIgZm9vYmFyLWRldi1tcXR0LiA8L3A+CjxwPkNvcHkgdGhlIEhUVFAgZW5kcG9pbnQgKGh0dHBzOi8veHh4eHguZXhlY3V0ZS1hcGkudXMtZWFzdC0xLmFtYXpvbmF3cy5jb20vZGV2KSB0byB1c2UgaW4gdGhlIGNsaWVudC1zaWRlIGNvZGUuPC9wPgo8cD5JbiB0aGUgYnJvd3Nlciwgd2UgZmV0Y2ggdGhlIFdlYlNvY2tldCBVUkwgYW5kIGluaXRpYXRlIGEgY29ubmVjdGlvbiB1c2luZyBtcXR0LiBIZXJlJ3MgYW4gZXhhbXBsZTo8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWpzIj48c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gY2xpZW50LmpzPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+Y29uc3Q8L3NwYW4+IG1xdHQgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnJlcXVpcmU8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidtcXR0Jzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5jb25zdDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGNvbnN0YW50Ij5FTkRQT0lOVF9VUkw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J2h0dHBzOi8veHh4eHguZXhlY3V0ZS1hcGkudXMtZWFzdC0xLmFtYXpvbmF3cy5jb20vZGV2Jzwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmFzeW5jPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+ZnVuY3Rpb248L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+Y29ubmVjdDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBjb21tZW50Ij4vLyBmZXRjaCBVUkwgYW5kIGFyYml0cmFyeSBjaGFubmVsSWQgZnJvbSBMYW1iZGEgZnVuY3Rpb24gIzEgKHNlc3Npb24pPC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5sZXQ8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4gY2hhbm5lbElkPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiBlbmRwb2ludFVybCA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmF3YWl0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmZldGNoPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gY29uc3RhbnQiPkVORFBPSU5UX1VSTDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj50aGVuPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj5yZXNwPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj0+PC9zcGFuPiByZXNwPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+anNvbjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+bGV0PC9zcGFuPiBjaGFubmVsIDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gbXF0dDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmNvbm5lY3Q8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPmVuZHBvaW50VXJsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgogIGNoYW5uZWw8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5vbjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J2Nvbm5lY3QnPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgY2hhbm5lbDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnN1YnNjcmliZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXN0cmluZyI+PHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXB1bmN0dWF0aW9uIHN0cmluZyI+YDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj5mb29iYXIvPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBpbnRlcnBvbGF0aW9uIj48c3BhbiBjbGFzcz0idG9rZW4gaW50ZXJwb2xhdGlvbi1wdW5jdHVhdGlvbiBwdW5jdHVhdGlvbiI+JHs8L3NwYW4+Y2hhbm5lbElkPHNwYW4gY2xhc3M9InRva2VuIGludGVycG9sYXRpb24tcHVuY3R1YXRpb24gcHVuY3R1YXRpb24iPn08L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPi9yZXNwb25zZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gdGVtcGxhdGUtcHVuY3R1YXRpb24gc3RyaW5nIj5gPC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PT48L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4KICAgICAgPHNwYW4gY2xhc3M9InRva2VuIGNvbW1lbnQiPi8vIHB1Ymxpc2ggYSBtZXNzYWdlIHRvIHRoZSAnZm9vYmFyL3Nlc3Npb24nIHRvcGljIDwvc3Bhbj4KICAgICAgPHNwYW4gY2xhc3M9InRva2VuIGNvbW1lbnQiPi8vIHdoaWNoIHRyaWdnZXJzIExhbWJkYSBmdW5jdGlvbiAjMiAobXF0dCk8L3NwYW4+CiAgICAgIGNoYW5uZWw8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5wdWJsaXNoPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4nZm9vYmFyL3Nlc3Npb24nPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgICAgIHBheWxvYWQ8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBjb25zdGFudCI+SlNPTjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5zdHJpbmdpZnk8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4gY2hhbm5lbElkIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgICAgIHFvczxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG51bWJlciI+MTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBjb21tZW50Ij4vLyBMaXN0ZW4gZm9yIG1lc3NhZ2VzPC9zcGFuPgogICAgICBjaGFubmVsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+b248L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidtZXNzYWdlJzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj50b3BpYzxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gYnVmZmVyPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgICAgIGNvbnNvbGU8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5sb2c8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4gdG9waWM8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IG1lc3NhZ2U8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IGJ1ZmZlcjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnRvU3RyaW5nPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5jb25uZWN0PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+PC9jb2RlPjwvcHJlPgo8cD5TbyBmYXIgd2UgaGF2ZSBkZXBsb3llZCB0d28gbGFtYmRhIGZ1bmN0aW9uczogdGhlIGZpcnN0IGdlbmVyYXRlcyBhIHNpZ25lZCBXZWJTb2NrZXQgVVJMIGFuZCB0aGUgc2Vjb25kIHJlc3BvbmRzIGJ5IHB1Ymxpc2hpbmcgbWVzc2FnZXMgdXNpbmcgQVdTLklvdERhdGEuIDwvcD4KPHA+SG93ZXZlciwgcmVzcG9uZGluZyBpbiBBV1MgTGFtYmRhIHVzaW5nIElvdERhdGEgaXMgbGltaXRlZCBiZWNhdXNlIHdlIGNhbiBvbmx5IHNlbmQgb25lIG1lc3NhZ2UgZnJvbSB0aGUgY2xpZW50ICh0aGUgZmlyc3QgbWVzc2FnZSB0aGF0IGluaXRpYXRlcyB0aGUgc2Vzc2lvbikuIFdoYXQgaWYgd2Ugd2FudCB0byByZXNwb25kIHRvIGEgc3RyZWFtIG9mIG1lc3NhZ2VzPyBJbiB0aGF0IGNhc2UsIHdlJ2xsIHVzZSB0aGUgTVFUVCBwYWNrYWdlIG9uIHRoZSBzZXJ2ZXIgc2lkZSBhcyB3ZWxsLjwvcD4KPHA+T3VyIG5ldyB2ZXJzaW9uIG9mIExhbWJkYSBmdW5jdGlvbiAjMiAobXF0dCkgbWlnaHQgbG9vayBsaWtlIHRoaXM6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1qcyI+PHNwYW4gY2xhc3M9InRva2VuIGNvbW1lbnQiPi8vIGhhbmRsZXIuanM8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5jb25zdDwvc3Bhbj4gbXF0dCA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+cmVxdWlyZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J21xdHQnPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmNvbnN0PC9zcGFuPiBjcmVhdGVQcmVzaWduZWRVUkwgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnJlcXVpcmU8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidhd3Mtc2lnbi1tcXR0Jzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5jb25zdDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uLXZhcmlhYmxlIGZ1bmN0aW9uIj5jb25uZWN0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+IGNoYW5uZWwgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PT48L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPm5ldzwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGNsYXNzLW5hbWUiPlByb21pc2U8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj5yZXNvbHZlPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiByZWplY3Q8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj0+PC9zcGFuPiBjaGFubmVsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+b248L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidjb25uZWN0Jzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IHJlc29sdmU8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+Y29uc3Q8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbi12YXJpYWJsZSBmdW5jdGlvbiI+c3Vic2NyaWJlPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+IGNoYW5uZWw8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IHRvcGljIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj0+PC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5uZXc8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBjbGFzcy1uYW1lIj5Qcm9taXNlPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHBhcmFtZXRlciI+cmVzb2x2ZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gcmVqZWN0PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gY2hhbm5lbDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnN1YnNjcmliZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+dG9waWM8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IHJlc29sdmU8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgogCm1vZHVsZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj5leHBvcnRzPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbi12YXJpYWJsZSBmdW5jdGlvbiI+bXF0dDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+YXN5bmM8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj5wYXlsb2FkPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiBjb250ZXh0PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiBjYWxsYmFjazwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PT48L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+Y29uc3Q8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4gY2hhbm5lbElkIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiBwYXlsb2FkCiAgPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmNvbnN0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gY29uc3RhbnQiPlRPUElDX1JFUVVFU1Q8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXN0cmluZyI+PHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXB1bmN0dWF0aW9uIHN0cmluZyI+YDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj5mb29iYXIvPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBpbnRlcnBvbGF0aW9uIj48c3BhbiBjbGFzcz0idG9rZW4gaW50ZXJwb2xhdGlvbi1wdW5jdHVhdGlvbiBwdW5jdHVhdGlvbiI+JHs8L3NwYW4+Y2hhbm5lbElkPHNwYW4gY2xhc3M9InRva2VuIGludGVycG9sYXRpb24tcHVuY3R1YXRpb24gcHVuY3R1YXRpb24iPn08L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPi9yZXF1ZXN0PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiB0ZW1wbGF0ZS1wdW5jdHVhdGlvbiBzdHJpbmciPmA8L3NwYW4+PC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5jb25zdDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGNvbnN0YW50Ij5UT1BJQ19SRVNQT05TRTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gdGVtcGxhdGUtc3RyaW5nIj48c3BhbiBjbGFzcz0idG9rZW4gdGVtcGxhdGUtcHVuY3R1YXRpb24gc3RyaW5nIj5gPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPmZvb2Jhci88L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGludGVycG9sYXRpb24iPjxzcGFuIGNsYXNzPSJ0b2tlbiBpbnRlcnBvbGF0aW9uLXB1bmN0dWF0aW9uIHB1bmN0dWF0aW9uIj4kezwvc3Bhbj5jaGFubmVsSWQ8c3BhbiBjbGFzcz0idG9rZW4gaW50ZXJwb2xhdGlvbi1wdW5jdHVhdGlvbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+L3Jlc3BvbnNlPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiB0ZW1wbGF0ZS1wdW5jdHVhdGlvbiBzdHJpbmciPmA8L3NwYW4+PC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5jb25zdDwvc3Bhbj4gY2hhbm5lbCA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IG1xdHQ8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5jb25uZWN0PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmNyZWF0ZVByZXNpZ25lZFVSTDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+YXdhaXQ8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+Y29ubmVjdDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPiBjaGFubmVsIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmF3YWl0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnN1YnNjcmliZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPiBjaGFubmVsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiB0b3BpYzxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGNvbnN0YW50Ij5UT1BJQ19SRVFVRVNUPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5sZXQ8L3NwYW4+IHJlc29sdmUKICA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+bGV0PC9zcGFuPiBwcm9taXNlIDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPm5ldzwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGNsYXNzLW5hbWUiPlByb21pc2U8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwYXJhbWV0ZXIiPnJlczwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgcmVzb2x2ZSA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IHJlcwogIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmNvbnN0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24tdmFyaWFibGUgZnVuY3Rpb24iPnNlc3Npb25UaW1lb3V0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PT48L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c2V0VGltZW91dDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgY2hhbm5lbDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmVuZDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+cmVzb2x2ZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gbnVtYmVyIj4zMDAwMDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmxldDwvc3Bhbj4gdGltZW91dCA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c2Vzc2lvblRpbWVvdXQ8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICBjaGFubmVsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+b248L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidtZXNzYWdlJzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj50b3BpYzxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gYnVmZmVyPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgY29uc29sZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmxvZzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPiB0b3BpYzxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gbWVzc2FnZTxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gYnVmZmVyPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+dG9TdHJpbmc8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+Y2xlYXJUaW1lb3V0PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj50aW1lb3V0PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgogICAgdGltZW91dCA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c2Vzc2lvblRpbWVvdXQ8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICAgIGNoYW5uZWw8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5wdWJsaXNoPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gY29uc3RhbnQiPlRPUElDX1JFU1BPTlNFPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgICBxb3M8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBudW1iZXIiPjE8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgICBwYXlsb2FkPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gY29uc3RhbnQiPkpTT048L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c3RyaW5naWZ5PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+IG1lc3NhZ2U8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidQT05HJzwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gdGhpcyBwcm9taXNlIGlzIHJlc29sdmVkIGFmdGVyIDMwIHNlY29uZHMgb2YgaW5hY3Rpdml0eTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gZW5kaW5nIGZ1bmN0aW9uIGV4ZWN1dGlvbi4gSWYgd2UgZG9uJ3QgcHJvbWlzaWZ5IHRoZXNlIGV2ZW50PC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBjb21tZW50Ij4vLyBoYW5kbGVycywgdGhlbiB0aGUgTGFtYmRhIGZ1bmN0aW9uIHdpbGwgZW5kIHByZW1hdHVyZWx5Ljwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+YXdhaXQ8L3NwYW4+IHByb21pc2U8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj50aGVuPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj0+PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmNhbGxiYWNrPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+bnVsbDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+PC9jb2RlPjwvcHJlPgo8cD5UaGUgcHJpbWFyeSBkaWZmZXJlbmNlIGJldHdlZW4gdGhpcyB2ZXJzaW9uIGFuZCB3aGF0IHdlIGhhZCBiZWZvcmUgaXMgdGhhdCBub3cgd2UncmUgdXNpbmcgTVFUVCB0byBsaXN0ZW4gZm9yIG1lc3NhZ2VzIGFuZCByZXNwb25kIHJhdGhlciB0aGFuIEFXUy5Jb3REYXRhLiBUaGlzIGlzIG5lY2Vzc2FyeSBmb3IgdHdvLXdheSBjb21tdW5pY2F0aW9uIGJldHdlZW4gY2xpZW50IGFuZCBzZXJ2ZXIuPC9wPgo8cD5XZSBjYW4gdGhlbiByZXZpc2Ugb3VyIGNsaWVudC1zaWRlIGNvZGUgYXMgZm9sbG93czo8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWpzIj48c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gY2xpZW50LmpzPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+Y29uc3Q8L3NwYW4+IG1xdHQgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnJlcXVpcmU8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidtcXR0Jzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5jb25zdDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGNvbnN0YW50Ij5FTkRQT0lOVF9VUkw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J2h0dHBzOi8veHh4eHguZXhlY3V0ZS1hcGkudXMtZWFzdC0xLmFtYXpvbmF3cy5jb20vZGV2Jzwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmFzeW5jPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+ZnVuY3Rpb248L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+Y29ubmVjdDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBjb21tZW50Ij4vLyBmZXRjaCBVUkwgYW5kIGFyYml0cmFyeSBjaGFubmVsSWQgZnJvbSBMYW1iZGEgZnVuY3Rpb24gIzEgKHNlc3Npb24pPC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5sZXQ8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4gZW5kcG9pbnRVcmw8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IGNoYW5uZWxJZCA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmF3YWl0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmZldGNoPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gY29uc3RhbnQiPkVORFBPSU5UX1VSTDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj50aGVuPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj5yZXNwPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj0+PC9zcGFuPiByZXNwPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+anNvbjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+bGV0PC9zcGFuPiBjaGFubmVsIDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gbXF0dDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmNvbm5lY3Q8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPmVuZHBvaW50VXJsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgogIGNoYW5uZWw8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5vbjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J2Nvbm5lY3QnPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgY2hhbm5lbDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnN1YnNjcmliZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXN0cmluZyI+PHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXB1bmN0dWF0aW9uIHN0cmluZyI+YDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj5mb29iYXIvPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBpbnRlcnBvbGF0aW9uIj48c3BhbiBjbGFzcz0idG9rZW4gaW50ZXJwb2xhdGlvbi1wdW5jdHVhdGlvbiBwdW5jdHVhdGlvbiI+JHs8L3NwYW4+Y2hhbm5lbElkPHNwYW4gY2xhc3M9InRva2VuIGludGVycG9sYXRpb24tcHVuY3R1YXRpb24gcHVuY3R1YXRpb24iPn08L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPi9yZXNwb25zZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gdGVtcGxhdGUtcHVuY3R1YXRpb24gc3RyaW5nIj5gPC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBrZXl3b3JkIj5hc3luYzwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgICA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gcHVibGlzaCBhIG1lc3NhZ2UgdG8gdGhlICdmb29iYXIvc2Vzc2lvbicgdG9waWMgPC9zcGFuPgogICAgICA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gd2hpY2ggdHJpZ2dlcnMgTGFtYmRhIGZ1bmN0aW9uICMyIChtcXR0KTwvc3Bhbj4KICAgICAgPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmF3YWl0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+bmV3PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gY2xhc3MtbmFtZSI+UHJvbWlzZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwYXJhbWV0ZXIiPnJlc29sdmU8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IHJlamVjdDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PT48L3NwYW4+IAogICAgICAgIGNoYW5uZWw8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5wdWJsaXNoPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj4KICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidmb29iYXIvc2Vzc2lvbic8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+CiAgICAgICAgICAgIHBheWxvYWQ8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBjb25zdGFudCI+SlNPTjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5zdHJpbmdpZnk8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4gY2hhbm5lbElkIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgICAgICAgICBxb3M8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBudW1iZXIiPjE8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgICAgICAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgICAgICAgIHJlc29sdmUKICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICAgICAgCiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBjb21tZW50Ij4vLyBMaXN0ZW4gZm9yIG1lc3NhZ2VzPC9zcGFuPgogICAgICBjaGFubmVsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+b248L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidtZXNzYWdlJzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj50b3BpYzxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gYnVmZmVyPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49Pjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgICAgIGNvbnNvbGU8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5sb2c8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4gdG9waWM8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IG1lc3NhZ2U8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IGJ1ZmZlcjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnRvU3RyaW5nPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgICAgIAogICAgICBjaGFubmVsPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+cHVibGlzaDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+CiAgICAgICAgPHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXN0cmluZyI+PHNwYW4gY2xhc3M9InRva2VuIHRlbXBsYXRlLXB1bmN0dWF0aW9uIHN0cmluZyI+YDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj5mb29iYXIvPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBpbnRlcnBvbGF0aW9uIj48c3BhbiBjbGFzcz0idG9rZW4gaW50ZXJwb2xhdGlvbi1wdW5jdHVhdGlvbiBwdW5jdHVhdGlvbiI+JHs8L3NwYW4+Y2hhbm5lbElkPHNwYW4gY2xhc3M9InRva2VuIGludGVycG9sYXRpb24tcHVuY3R1YXRpb24gcHVuY3R1YXRpb24iPn08L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPi9yZXF1ZXN0PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiB0ZW1wbGF0ZS1wdW5jdHVhdGlvbiBzdHJpbmciPmA8L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gY29uc3RhbnQiPkpTT048L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c3RyaW5naWZ5PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+IG1lc3NhZ2U8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidoZWxsbyc8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4gcW9zPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gbnVtYmVyIj4xPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmNvbm5lY3Q8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj48L2NvZGU+PC9wcmU+CjxwPldoYXQncyBkaWZmZXJlbnQ/IFRoaXMgdGltZSB3ZSBpc3N1ZSBhIHJlcXVlc3QgdXNpbmcgdGhlIHRvcGljIGZvb2Jhci97Y2hhbm5lbElkfS9yZXF1ZXN0LiBBcyBiZWZvcmUsIHdlIGxpc3RlbiBmb3IgbWVzc2FnZXMgdXNpbmcgdGhlIHRvcGljIGZvb2Jhci97Y2hhbm5lbElkfS9yZXNwb25zZS48L3A+CjxwPldoZW4gd2UgcnVuIHRoZSBhYm92ZSBjbGllbnQtc2lkZSBjb2RlLCBoZXJlJ3Mgd2hhdCBoYXBwZW5zOjwvcD4KPG9sPgogIDxsaT5UaGUgY2xpZW50IGZldGNoZXMgdGhlIHNpZ25lZCBXZWJTb2NrZXQgVVJMIGFuZCBjaGFubmVsSWQgZnJvbSBMYW1iZGEgZnVuY3Rpb24gIzEgKHNlc3Npb24pLjwvbGk+CiAgPGxpPlRoZSBjbGllbnQgdXNlcyBNUVRUIHRvIGNvbm5lY3QgdG8gdGhlIFdlYlNvY2tldCBVUkw8L2xpPgogIDxsaT5XZSB3YWl0IGZvciBhIGNvbm5lY3Rpb24gYW5kIHRoZW4gc3Vic2NyaWJlIHRvIHRoZSB0b3BpYyBmb29iYXIve2NoYW5uZWxJZH0vcmVzcG9uc2U8L2xpPgogIDxsaT5XZSBwdWJsaXNoIGEgbWVzc2FnZSB0byBmb29iYXIvc2Vzc2lvbiB3aGljaCB0cmlnZ2VycyBMYW1iZGEgZnVuY3Rpb24gIzIgKG1xdHQpLiBUaGUgcGF5bG9hZCBpbmNsdWRlcyB0aGUgY2hhbm5lbElkLiZuYnNwOzwvbGk+CiAgPGxpPkxhbWJkYSBmdW5jdGlvbiAjMiAobXF0dCkgaW5kZXBlbmRlbnRseSBnZW5lcmF0ZXMgYSBzaWduZWQgV2ViU29ja2V0IHVybCBhbmQgY29ubmVjdHMgdmlhIE1RVFQuIExhbWJkYSBmdW5jdGlvbiAjMiB3YWl0cyBmb3IgbWVzc2FnZXMgYW5kIHRpbWVzIG91dCBhZnRlciAzMCBzZWNvbmRzIG9mIGluYWN0aXZpdHkuJm5ic3A7PC9saT4KPC9vbD4KPGgyPkV4YW1wbGUgUHJvamVjdHMgVXNpbmcgVGhpcyBBcHByb2FjaDwvaDI+CjxwPlNvbWV0aW1lcyBpdCdzIGJlc3QgdG8gbG9vayBhdCB0aGUgc291cmNlIGNvZGUgb2YgcmVhbCBwcm9qZWN0cyByYXRoZXIgdGhhbiBtdWRkbGUgdGhyb3VnaCBoYWxmLWJha2VkIHR1dG9yaWFscy4gVG8gdGhhdCBlbmQsIGhlcmUgYXJlIHNvbWUgZXhhbXBsZXM6PC9wPgo8aDM+TmFtZXdoaXNrPC9oMz4KPHVsPgogIDxsaT5MYW1iZGEgZnVuY3Rpb246IDxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS91bnNoaWZ0L25hbWV3aGlzay9ibG9iL21hc3Rlci9wdWJzdWIvc3JjL3J1bi5qcyNMNjAiPmh0dHBzOi8vZ2l0aHViLmNvbS91bnNoaWZ0L25hbWV3aGlzay9ibG9iL21hc3Rlci9wdWJzdWIvc3JjL3J1bi5qcyNMNjA8L2E+PC9saT4KICA8bGk+Q2xpZW50OiA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vdW5zaGlmdC9uYW1ld2hpc2svYmxvYi9tYXN0ZXIvc3JjL2xpYi9yZW1vdGUuanMiPmh0dHBzOi8vZ2l0aHViLmNvbS91bnNoaWZ0L25hbWV3aGlzay9ibG9iL21hc3Rlci9zcmMvbGliL3JlbW90ZS5qczwvYT48L2xpPgogIDxsaT5JbiB0aGUgd2lsZDogPGEgaHJlZj0iaHR0cHM6Ly9uYW1ld2hpc2suY29tLyI+aHR0cHM6Ly9uYW1ld2hpc2suY29tLzwvYT48L2xpPgo8L3VsPgo8aDM+U2FmZnJvbjwvaDM+Cjx1bD4KICA8bGk+TGFtYmRhIGZ1bmN0aW9uOiA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vdW5zaGlmdC9zYWZmcm9uL2Jsb2IvbWFzdGVyL3NlcnZlcmxlc3Mvc3JjL2hhbmRsZXIuanMjTDEyMyI+aHR0cHM6Ly9naXRodWIuY29tL3Vuc2hpZnQvc2FmZnJvbi9ibG9iL21hc3Rlci9zZXJ2ZXJsZXNzL3NyYy9oYW5kbGVyLmpzI0wxMjM8L2E+PC9saT4KICA8bGk+Q2xpZW50OiA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vdW5zaGlmdC9zYWZmcm9uL2Jsb2IvbWFzdGVyL3NyYy9saWIvY29ubmVjdC5qcyI+aHR0cHM6Ly9naXRodWIuY29tL3Vuc2hpZnQvc2FmZnJvbi9ibG9iL21hc3Rlci9zcmMvbGliL2Nvbm5lY3QuanM8L2E+PC9saT4KICA8bGk+SW4gdGhlIHdpbGQ6IDxhIGhyZWY9Imh0dHBzOi8vYTc1ZzA1Y2R1ZC5leGVjdXRlLWFwaS51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS9zdGFnaW5nLyI+aHR0cHM6Ly9hNzVnMDVjZHVkLmV4ZWN1dGUtYXBpLnVzLWVhc3QtMS5hbWF6b25hd3MuY29tL3N0YWdpbmcvPC9hPjwvbGk+CjwvdWw+","excerpt":"","image":{"id":"cjkvp9ora072l01219ttici63","url":"static/cjkq4u7470ihr0157ad175b12/MQTT.js.png"},"posts_tags":[{"tag":{"id":"3pl7ejawubufz70vjnad","name":"AWS"}}],"date":"01/12/2020","html":"<p>AWS Lambda is usually used for short-lived processes like the request/response lifecycle. The default Lambda timeout of 3 seconds reflects this common use-case.</p>\n<img src=\"https://s3.amazonaws.com/contentkit/static/cjkq4u7470ihr0157ad175b12/aws-lambda-limits.png\" />\n<p>However the maximum execution duration of AWS Lambda functions was increased from 1 minute to 5 minutes a few years ago. </p>\n<p>Not only is it possible to connect to AWS Lambda via WebSockets using MQTT or AWS IoTData but this strategy works surprisingly well.</p>\n<p>MQTT is both a general publish-subscribe messaging protocol and a popular npm package. MQTT (the npm package) has a clean interface that enables initiating a WebSocket connection, subscribing to topics, listening for messages, and publishing messages.</p>\n<h2>Overall Strategy</h2>\n<img src=\"https://s3.amazonaws.com/contentkit/static/cjkq4u7470ihr0157ad175b12/MQTT.js.png\" />\n<p>On the client side, we fetch a WebSocket url that formally looks something like this:</p>\n<pre><code>wss://XXXXX.iot.us-east-1.amazonaws.com/mqtt?X-Amz-Date=20180812T133259Z&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ZZZ%2F20180812%2Fus-east-1%2Fiotdevicegateway%2Faws4_request&X-Amz-SignedHeaders=host&X-Amz-Signature=PPP&X-Amz-Security-Token=QQQ</code></pre>\n<p>This can be generated using aws-sign-mqtt:</p>\n<pre><code class=\"language-js\"><span class=\"token comment\">// set the AWS_IOT_HOST environmental variable:</span>\n<span class=\"token comment\">// export AWS_IOT_HOST=$(aws --region us-east-1 iot describe-endpoint --output text)</span>\n<span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aws-sign-mqtt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre>\n<p>This is just a WebSocket URL signed using AWS signature v4.</p>\n<p>This WebSocket URL should obviously be generated server-side (lest you expose your AWS credentials).</p>\n<p>To demonstrate how AWS Lambda can be used for long-lived WebSocket connections, we'll create two simple Lambda functions. The first is a simple HTTP endpoint that returns a signed WebSocket url. The second lambda function is triggered when the client subscribes to an AWS IoT topic. </p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token constant\">AWS</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aws-sdk'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> createPresignedURL <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aws-sign-mqtt'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> randomBytes <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'crypto'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Lambda function #1 - session</span>\n<span class=\"token comment\">// Simple HTTP endpoint that returns the WebSocket URL and channel ID</span>\nmodule<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">session</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> endpointUrl <span class=\"token operator\">=</span> <span class=\"token function\">createPresignedURL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// create an arbitrary channel ID to identify the current session</span>\n  <span class=\"token keyword\">const</span> channelId <span class=\"token operator\">=</span> <span class=\"token function\">randomBytes</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span> \n  <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    statusCode<span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n    body<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> endpointUrl<span class=\"token punctuation\">,</span> channelId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    headers<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">'Access-Control-Allow-Origin'</span><span class=\"token operator\">:</span> <span class=\"token string\">'*'</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// Lambda function #2 - mqtt</span>\n<span class=\"token comment\">// Sends messages to the client via AWS IotData.</span>\n<span class=\"token comment\">// You must manually set the AWS_IOT_HOST environmental variable which is account-specific.</span>\n<span class=\"token comment\">// From the command line run: aws iot describe-endpoint --output text</span>\nmodule<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">mqtt</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">payload<span class=\"token punctuation\">,</span> context</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// The payload is whatever we send from the browser</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> channelId <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> payload\n  <span class=\"token keyword\">const</span> iot <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AWS<span class=\"token punctuation\">.</span>IotData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    endpoint<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">AWS_IOT_HOST</span><span class=\"token punctuation\">,</span>\n    region<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">AWS_REGION</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// we respond with a different topic that uses the channelID</span>\n  <span class=\"token comment\">// to avoid broadcasting the same message to all users</span>\n  <span class=\"token keyword\">await</span> iot<span class=\"token punctuation\">.</span><span class=\"token function\">publish</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    topic<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">foobar/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>channelId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/response</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    payload<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> message<span class=\"token operator\">:</span> <span class=\"token string\">'hello'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    qos<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// at this point the Lambda function ends because the Node event loop is closed</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>Here's what our serverless.yml might look like:</p>\n<pre><code>service: foobar\nprovider:\n  name: aws\n  runtime: nodejs8.10\n  region: us-east-1\n  environment: \n    AWS_IOT_HOST: ''\n  iamRoleStatements:\n    - Effect: \"Allow\"\n      Action: \n        - iot:*\n      Resource: \"*\"\nfunctions:\n  session:\n    handler: handler.session\n    events:\n      - http:\n          method: GET\n          path: /\n          cors: true # change this in production to \"credentails: true\" to secure endpoint\n  mqtt:\n    handler: handler.mqtt\n    events: \n      - iot\n          sql: 'SELECT * FROM foobar/session'\n  </code></pre>\n<p>After deploying our function (sls deploy), serverless will print the session endpoint that we need to generate the WebSocket URL:</p>\n<pre><code>Service Information\nservice: foobar\nregion: us-east-1\nstack: foobar-dev\napi keys:\n  None\nendpoints:\n  GET - https://xxxxx.execute-api.us-east-1.amazonaws.com/dev\n  GET - https://xxxxx.execute-api.us-east-1.amazonaws.com/dev\nfunctions:\n  mqtt: foobar-dev-mqtt\n  session: foobar-dev-session</code></pre>\n<p>If you have the AWS command line interface installed you can try running something like the following from terminal to test your functions:</p>\n<pre><code class=\"language-bash\">aws --region us-east-1 iot-data publish --topic <span class=\"token string\">'foobar/session'</span> --payload <span class=\"token string\">'{ \"channelId\": \"1\" }'</span></code></pre>\n<p>The above command should trigger foobar-dev-mqtt. </p>\n<p>Copy the HTTP endpoint (https://xxxxx.execute-api.us-east-1.amazonaws.com/dev) to use in the client-side code.</p>\n<p>In the browser, we fetch the WebSocket URL and initiate a connection using mqtt. Here's an example:</p>\n<pre><code class=\"language-js\"><span class=\"token comment\">// client.js</span>\n<span class=\"token keyword\">const</span> mqtt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mqtt'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">ENDPOINT_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'https://xxxxx.execute-api.us-east-1.amazonaws.com/dev'</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">connect</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// fetch URL and arbitrary channelId from Lambda function #1 (session)</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">{</span> channelId<span class=\"token punctuation\">,</span> endpointUrl <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ENDPOINT_URL</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resp</span> <span class=\"token operator\">=></span> resp<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> channel <span class=\"token operator\">=</span> mqtt<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>endpointUrl<span class=\"token punctuation\">)</span>\n  channel<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'connect'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    channel<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">foobar/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>channelId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/response</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// publish a message to the 'foobar/session' topic </span>\n      <span class=\"token comment\">// which triggers Lambda function #2 (mqtt)</span>\n      channel<span class=\"token punctuation\">.</span><span class=\"token function\">publish</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foobar/session'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        payload<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> channelId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        qos<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// Listen for messages</span>\n      channel<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">topic<span class=\"token punctuation\">,</span> buffer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> topic<span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span> buffer<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre>\n<p>So far we have deployed two lambda functions: the first generates a signed WebSocket URL and the second responds by publishing messages using AWS.IotData. </p>\n<p>However, responding in AWS Lambda using IotData is limited because we can only send one message from the client (the first message that initiates the session). What if we want to respond to a stream of messages? In that case, we'll use the MQTT package on the server side as well.</p>\n<p>Our new version of Lambda function #2 (mqtt) might look like this:</p>\n<pre><code class=\"language-js\"><span class=\"token comment\">// handler.js</span>\n<span class=\"token keyword\">const</span> mqtt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mqtt'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> createPresignedURL <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aws-sign-mqtt'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">connect</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> channel <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'connect'</span><span class=\"token punctuation\">,</span> resolve<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">subscribe</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> channel<span class=\"token punctuation\">,</span> topic <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span>topic<span class=\"token punctuation\">,</span> resolve<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n \nmodule<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">mqtt</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">payload<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> channelId <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> payload\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">TOPIC_REQUEST</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">foobar/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>channelId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/request</span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">TOPIC_RESPONSE</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">foobar/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>channelId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/response</span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token keyword\">const</span> channel <span class=\"token operator\">=</span> mqtt<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token function\">createPresignedURL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> channel <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> channel<span class=\"token punctuation\">,</span> topic<span class=\"token operator\">:</span> <span class=\"token constant\">TOPIC_REQUEST</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> resolve\n  <span class=\"token keyword\">let</span> promise <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    resolve <span class=\"token operator\">=</span> res\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sessionTimeout</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    channel<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30000</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> timeout <span class=\"token operator\">=</span> <span class=\"token function\">sessionTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  channel<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">topic<span class=\"token punctuation\">,</span> buffer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> topic<span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span> buffer<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timeout<span class=\"token punctuation\">)</span>\n    timeout <span class=\"token operator\">=</span> <span class=\"token function\">sessionTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    channel<span class=\"token punctuation\">.</span><span class=\"token function\">publish</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TOPIC_RESPONSE</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      qos<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      payload<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> message<span class=\"token operator\">:</span> <span class=\"token string\">'PONG'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// this promise is resolved after 30 seconds of inactivity</span>\n  <span class=\"token comment\">// ending function execution. If we don't promisify these event</span>\n  <span class=\"token comment\">// handlers, then the Lambda function will end prematurely.</span>\n  <span class=\"token keyword\">await</span> promise<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>The primary difference between this version and what we had before is that now we're using MQTT to listen for messages and respond rather than AWS.IotData. This is necessary for two-way communication between client and server.</p>\n<p>We can then revise our client-side code as follows:</p>\n<pre><code class=\"language-js\"><span class=\"token comment\">// client.js</span>\n<span class=\"token keyword\">const</span> mqtt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mqtt'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">ENDPOINT_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'https://xxxxx.execute-api.us-east-1.amazonaws.com/dev'</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">connect</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// fetch URL and arbitrary channelId from Lambda function #1 (session)</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">{</span> endpointUrl<span class=\"token punctuation\">,</span> channelId <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ENDPOINT_URL</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resp</span> <span class=\"token operator\">=></span> resp<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> channel <span class=\"token operator\">=</span> mqtt<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>endpointUrl<span class=\"token punctuation\">)</span>\n  channel<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'connect'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    channel<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">foobar/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>channelId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/response</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// publish a message to the 'foobar/session' topic </span>\n      <span class=\"token comment\">// which triggers Lambda function #2 (mqtt)</span>\n      <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> \n        channel<span class=\"token punctuation\">.</span><span class=\"token function\">publish</span><span class=\"token punctuation\">(</span>\n          <span class=\"token string\">'foobar/session'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n            payload<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> channelId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            qos<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          resolve\n        <span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span>\n      \n      <span class=\"token comment\">// Listen for messages</span>\n      channel<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'message'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">topic<span class=\"token punctuation\">,</span> buffer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> topic<span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span> buffer<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      \n      channel<span class=\"token punctuation\">.</span><span class=\"token function\">publish</span><span class=\"token punctuation\">(</span>\n        <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">foobar/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>channelId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/request</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> message<span class=\"token operator\">:</span> <span class=\"token string\">'hello'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span> qos<span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre>\n<p>What's different? This time we issue a request using the topic foobar/{channelId}/request. As before, we listen for messages using the topic foobar/{channelId}/response.</p>\n<p>When we run the above client-side code, here's what happens:</p>\n<ol>\n  <li>The client fetches the signed WebSocket URL and channelId from Lambda function #1 (session).</li>\n  <li>The client uses MQTT to connect to the WebSocket URL</li>\n  <li>We wait for a connection and then subscribe to the topic foobar/{channelId}/response</li>\n  <li>We publish a message to foobar/session which triggers Lambda function #2 (mqtt). The payload includes the channelId.&nbsp;</li>\n  <li>Lambda function #2 (mqtt) independently generates a signed WebSocket url and connects via MQTT. Lambda function #2 waits for messages and times out after 30 seconds of inactivity.&nbsp;</li>\n</ol>\n<h2>Example Projects Using This Approach</h2>\n<p>Sometimes it's best to look at the source code of real projects rather than muddle through half-baked tutorials. To that end, here are some examples:</p>\n<h3>Namewhisk</h3>\n<ul>\n  <li>Lambda function: <a href=\"https://github.com/unshift/namewhisk/blob/master/pubsub/src/run.js#L60\">https://github.com/unshift/namewhisk/blob/master/pubsub/src/run.js#L60</a></li>\n  <li>Client: <a href=\"https://github.com/unshift/namewhisk/blob/master/src/lib/remote.js\">https://github.com/unshift/namewhisk/blob/master/src/lib/remote.js</a></li>\n  <li>In the wild: <a href=\"https://namewhisk.com/\">https://namewhisk.com/</a></li>\n</ul>\n<h3>Saffron</h3>\n<ul>\n  <li>Lambda function: <a href=\"https://github.com/unshift/saffron/blob/master/serverless/src/handler.js#L123\">https://github.com/unshift/saffron/blob/master/serverless/src/handler.js#L123</a></li>\n  <li>Client: <a href=\"https://github.com/unshift/saffron/blob/master/src/lib/connect.js\">https://github.com/unshift/saffron/blob/master/src/lib/connect.js</a></li>\n  <li>In the wild: <a href=\"https://a75g05cdud.execute-api.us-east-1.amazonaws.com/staging/\">https://a75g05cdud.execute-api.us-east-1.amazonaws.com/staging/</a></li>\n</ul>"}}}}