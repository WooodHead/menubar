{"componentChunkName":"component---src-components-post-tsx","path":"/running-a-simple-node-web-server-on-aws-ec2","result":{"pageContext":{"post":{"id":"cjn3l18390lyt0158i8qxs5dc","title":"Running A Simple Node Web Server On AWS EC2","slug":"running-a-simple-node-web-server-on-aws-ec2","published_at":"2018-10-11T02:35:54.72","created_at":"2018-10-10T20:03:59","encoded_html":"PHA+SG93IGRvIHlvdSBydW4gYSB3ZWIgc2VydmVyIG9uIEVDMj88L3A+CjxwPkkndmUgdXNlZCBBV1MgTGFtYmRhIGFuZC9vciBDbG91ZGZvcm1hdGlvbiBleHRlbnNpdmVseSBidXQgd2FzIGN1cmlvdXMgdG8gc2VlIGhvdyBkaWZmaWN1bHQgaXQgaXMgdG8gc3BpbiB1cCBhIEVDMiBpbnN0YW5jZSBhbmQgZXhwb3NlIHRoZSByaWdodCBwb3J0cyBmcm9tIHRoZSBjb21tYW5kIGxpbmUuIFVzaW5nIEFXUycgY29tbWFuZCBsaW5lIGludGVyZmFjZSBUaGlzIGlzIGEgZ29vZCBhcHByb2FjaCBmb3IgdGVzdGluZyBhbmQgcGxheWluZyB3aXRoIHRvb2xzIGFuZCBoYXMgYWR2YW50YWdlcyBvdmVyIENsb3VkZm9ybWF0aW9uLiBEZWJ1Z2dpbmcgQ2xvdWRmb3JtYXRpb24gY2FuIGJlIGEgaHVnZSBwYWluLiBBbHNvIGNyZWF0aW5nIGFuZCB1cGRhdGluZyBzdGFja3MgY2FuIHRha2UgYSBiaXQgbG9uZ2VyIHRoYW4gc2ltcGx5IHJ1bm5pbmcgYW4gaW5zdGFuY2UgZnJvbSB0ZXJtaW5hbC48L3A+CjxoMj5CYWNrIHRvIHRoZSBCYXNpY3M8L2gyPgo8aDM+UGVycXVpc2l0ZXM8L2gzPgo8dWw+CiAgPGxpPkknbGwgYXNzdW1lIHlvdSd2ZSBpbnN0YWxsZWQgPHN0cm9uZz5BV1MgQ0xJPC9zdHJvbmc+LiBJZiBub3QsIHN0YXJ0IDxhIGhyZWY9Imh0dHBzOi8vZG9jcy5hd3MuYW1hem9uLmNvbS9jbGkvbGF0ZXN0L3VzZXJndWlkZS9pbnN0YWxsaW5nLmh0bWwiPmhlcmU8L2E+LiBZb3UgY2FuIGNoZWNrIGJ5IHJ1bm5pbmcgPGNvZGU+Jm5ic3A7YXdzIC0tdmVyc2lvbi48L2NvZGU+PC9saT4KICA8bGk+SSdsbCBiZSB1c2luZyA8c3Ryb25nPmpxPC9zdHJvbmc+LCB3aGljaCBpcyBsaWtlIHNlZCBmb3IgSlNPTiBkYXRhLiBJbnN0YWxsIGl0IDxhIGhyZWY9Imh0dHBzOi8vc3RlZG9sYW4uZ2l0aHViLmlvL2pxLyI+aGVyZTwvYT4uPC9saT4KPC91bD4KPHA+V2hhdCBwYXJhbWV0ZXJzIGRvIHdlIG5lZWQgdG8gcnVuIGFuIGluc3RhbmNlPyBXZSBuZWVkOjwvcD4KPHVsPgogIDxsaT5UaGUgQW1hem9uIE1hY2hpbmUgSW1hZ2UgKEFNSSkgSUQuPC9saT4KICA8bGk+UHJpdmF0ZSBLZXkgTmFtZTwvbGk+CiAgPGxpPlN1Ym5ldCBJRDwvbGk+CiAgPGxpPlNlY3VyaXR5IEdyb3VwIElEczwvbGk+CiAgPGxpPlVzZXIgRGF0YTwvbGk+CjwvdWw+CjxwPkJlZm9yZSBydW5uaW5nIGFueSBjb21tYW5kcywgZXhwb3J0IHRoZSBBV1MgcmVnaW9uIHlvdSB3YW50IHRvIHVzZSBzbyB0aGF0IHlvdSdyZSBub3QgcHJvbXB0ZWQgZm9yIGV2ZXJ5IGNvbW1hbmQuIEknbGwgYmUgdXNpbmcgdXMtZWFzdC0xLjwvcD4KPHByZT48Y29kZSBjbGFzcz0ibGFuZ3VhZ2UtYmFzaCI+PHNwYW4gY2xhc3M9InRva2VuIGJ1aWx0aW4gY2xhc3MtbmFtZSI+ZXhwb3J0PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gYXNzaWduLWxlZnQgdmFyaWFibGUiPkFXU19ERUZBVUxUX1JFR0lPTjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+dXMtZWFzdC0xPC9jb2RlPjwvcHJlPgo8aDM+QW1hem9uIE1hY2hpbmUgSW1hZ2UgKEFNSSkgSUQ8L2gzPgo8cD5UaGlzIGlkZW50aWZpZXMgdGhlIGluc3RhbmNlIG9uIEFtYXpvbidzIG1hcmtldHBsYWNlLiBXZSdsbCBzdGljayB3aXRoIGRlZmF1bHRzIGFuZCB1c2UgdGhlIGxhdGVzdCBBbWF6b24gTGludXggSW1hZ2UuPC9wPgo8cD5SdW46PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj5hd3Mgc3NtIGdldC1wYXJhbWV0ZXJzIC0tbmFtZXMgL2F3cy9zZXJ2aWNlL2FtaS1hbWF6b24tbGludXgtbGF0ZXN0L2Ftem4yLWFtaS1odm0teDg2XzY0LWdwMiAtLXF1ZXJ5IDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidQYXJhbWV0ZXJzWzBdLltWYWx1ZV0nPC9zcGFuPiAtLW91dHB1dCB0ZXh0PC9jb2RlPjwvcHJlPgo8cD5BcyBvZiB0aGlzIHdyaXRpbmcsIHRoZSBsYXRlc3QgQW1hem9uIExpbnV4IEFNSSBpcyBhbWktMDkyMjU1M2I3YjAzNjkyNzMuPC9wPgo8aDM+UHJpdmF0ZSBLZXkgTmFtZTwvaDM+CjxwPldoZW4geW91IGNyZWF0ZSBhbiBFQzIgaW5zdGFuY2Ugb24gYXdzLmFtYXpvbi5jb20gdXNpbmcgdGhlIFVJIHlvdSdyZSBwcm9tcHRlZCB0byB1c2UgYW4gZXhpc3RpbmcgcHJpdmF0ZSBrZXkgb3IgY3JlYXRlIGEgbmV3IG9uZS4gVGhlIHByaXZhdGUga2V5IGlzIGp1c3QgdGhlIGxhYmVsIGFzc29jaWF0ZWQgd2l0aCBhIHNldCBvZiBwdWJsaWMgYW5kIHByaXZhdGUga2V5cyBhbGxvd2luZyBTU0ggYWNjZXNzIHRvIHlvdXIgaW5zdGFuY2UuPC9wPgo8cD5UaGlzIGNvbW1hbmQgbGlzdHMgYWxsIG9mIHlvdXIgZXhpc3Rpbmcga2V5IHBhaXJzOjwvcD4KPHByZT48Y29kZSBjbGFzcz0ibGFuZ3VhZ2UtYmFzaCI+YXdzIGVjMiBkZXNjcmliZS1rZXktcGFpcnMgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj58PC9zcGFuPiBqcSAtciA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4nLktleVBhaXJzJzwvc3Bhbj48L2NvZGU+PC9wcmU+CjxwPklmIHlvdSBkb24ndCBoYXZlIGFueSBrZXlzLCB5b3UgY2FuIGNyZWF0ZSBhIG5ldyBvbmU6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj5hd3MgZWMyIGNyZWF0ZS1rZXktcGFpciAtLWtleS1uYW1lIHdlYnNlcnZlciA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPnw8L3NwYW4+IGpxIC1yIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPicuS2V5TWF0ZXJpYWwnPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj48L3NwYW4+IH4vLnNzaC93ZWJzZXJ2ZXIucGVtPC9jb2RlPjwvcHJlPgo8cD5UaGlzIGNvbW1hbmQgc2F2ZXMgdGhlIFJTQSBrZXkgbWF0ZXJpYWwgdG8gfi8uc3NoL3dlYnNlcnZlci5wZW0uPC9wPgo8aDM+U3VibmV0IElEPC9oMz4KPHA+QVdTIGFjY291bnRzIGhhdmUgYSBkZWZhdWx0IFZQQywgc3VibmV0LCBhbmQgc2V0IG9mIHNlY3VyaXR5IGdyb3Vwcy48L3A+CjxwPlJhdGhlciB0aGFuIGNyZWF0ZSBhIG5ldyBzdWJuZXQgd2UnbGwganVzdCB1c2Ugb25lIG9mIHRoZSBzdWJuZXRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZGVmYXVsdCBWUEMuPC9wPgo8cD5IZXJlJ3MgaG93IHlvdSBsaXN0IHN1Ym5ldHM6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj5hd3MgZWMyIGRlc2NyaWJlLXN1Ym5ldHMgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj58PC9zcGFuPiBqcSAtciA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4nLlN1Ym5ldHMnPC9zcGFuPjwvY29kZT48L3ByZT4KPGgzPlNlY3VyaXR5IEdyb3VwIElEczwvaDM+CjxwPkZvciBhIHdlYiBzZXJ2ZXIsIHdlJ2xsIHVzZSB0d28gc2VjdXJpdHkgZ3JvdXBzOiBhIGRlZmF1bHQgc2VjdXJpdHkgZ3JvdXAgYXNzb2NpYXRlZCB3aXRoIHRoZSBkZWZhdWx0IFZQQywgYW5kIGEgY3VzdG9tIHNlY3VyaXR5IGdyb3VwIHRoYXQgZXhwb3NlcyBwb3J0cyAyMiAoU1NIKSwgODAgKEhUVFApLCBhbmQgNDQzIChIVFRQUykuPC9wPgo8cD5HZXQgdGhlIGRlZmF1bHQgc2VjdXJpdHkgZ3JvdXAgSUQgYXMgZm9sbG93czo8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWJhc2giPmF3cyBlYzIgZGVzY3JpYmUtc2VjdXJpdHktZ3JvdXBzIC0tZ3JvdXAtbmFtZSBkZWZhdWx0IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+fDwvc3Bhbj4ganEgLXIgPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+Jy5TZWN1cml0eUdyb3Vwc1swXS5Hcm91cElkJzwvc3Bhbj48L2NvZGU+PC9wcmU+CjxwPkFuZCBjcmVhdGUgYSBuZXcgc2VjdXJpdHkgZ3JvdXA6PC9wPgo8cHJlPjxjb2RlPmF3cyBlYzIgY3JlYXRlLXNlY3VyaXR5LWdyb3VwIC0tZ3JvdXAtbmFtZSB3ZWJzZXJ2ZXIgLS1kZXNjcmlwdGlvbiB3ZWJzZXJ2ZXIgfCBqcSAtciAnLkdyb3VwSWQnPC9jb2RlPjwvcHJlPgo8cD5Ob3cgd2UgbmVlZCB0byBydW4gYXV0aG9yaXplLXNlY3VyaXR5LWdyb3VwLWluZ3Jlc3MgdGhyZWUgdGltZXMgKG9uY2UgZm9yIGVhY2ggcG9ydCkuPC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj5hd3MgZWMyIGF1dGhvcml6ZS1zZWN1cml0eS1ncm91cC1pbmdyZXNzIC0tZ3JvdXAtbmFtZSB3ZWJzZXJ2ZXIgLS1wcm90b2NvbCB0Y3AgLS1wb3J0IDxzcGFuIGNsYXNzPSJ0b2tlbiBudW1iZXIiPjIyPC9zcGFuPiAtLWNpZHIgPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+JzAuMC4wLjAvMCc8L3NwYW4+CmF3cyBlYzIgYXV0aG9yaXplLXNlY3VyaXR5LWdyb3VwLWluZ3Jlc3MgLS1ncm91cC1uYW1lIHdlYnNlcnZlciAtLXByb3RvY29sIHRjcCAtLXBvcnQgPHNwYW4gY2xhc3M9InRva2VuIG51bWJlciI+ODA8L3NwYW4+IC0tY2lkciA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4nMC4wLjAuMC8wJzwvc3Bhbj4KYXdzIGVjMiBhdXRob3JpemUtc2VjdXJpdHktZ3JvdXAtaW5ncmVzcyAtLWdyb3VwLW5hbWUgd2Vic2VydmVyIC0tcHJvdG9jb2wgdGNwIC0tcG9ydCA8c3BhbiBjbGFzcz0idG9rZW4gbnVtYmVyIj40NDM8L3NwYW4+IC0tY2lkciA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4nMC4wLjAuMC8wJzwvc3Bhbj48L2NvZGU+PC9wcmU+CjxwPldlIG5lZWQgdG8gZXhwb3NlIHBvcnQgMjIgZm9yIFNTSCBhY2Nlc3MsIHBvcnQgODAgLSB0aGUgcG9ydCB0aGF0IG91ciBub2RlIHNlcnZlciB3aWxsIGxpc3RlbiB0bywgYW5kIHBvcnQgNDQzIGZvciBIVFRQUy48L3A+CjxoMj5Vc2VyIERhdGE8L2gyPgo8cD5Vc2VyIGRhdGEgbGV0cyB1cyBydW4gc2NyaXB0cyB3aGVuIHRoZSBpbnN0YW5jZSBpcyBsYXVuY2hlZC4gSW4gdGhpcyBjYXNlLCB3ZSBuZWVkIHRvIGluc3RhbGwgbm9kZSBhbmQgbnBtIG9uIHRoZSBFQzIgaW5zdGFuY2Ugd2hlbiBpdCdzIGNyZWF0ZWQuIENyZWF0ZSBhIG5ldyBmaWxlIChlLmcuLCB1c2VyLWRhdGEuc2gpIGFuZCBhZGQ6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj48c3BhbiBjbGFzcz0idG9rZW4gc2hlYmFuZyBpbXBvcnRhbnQiPiMhL2Jpbi9iYXNoIC12PC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnN1PC9zcGFuPiBlYzItdXNlciAtYyA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iY3VybCAtby0gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2NyZWF0aW9uaXgvbnZtL3YwLjMzLjIvaW5zdGFsbC5zaCB8IGJhc2giPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnN1PC9zcGFuPiBlYzItdXNlciAtYyA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4ic291cmNlIC9ob21lL2VjMi11c2VyLy5udm0vbnZtLnNoICZhbXA7JmFtcDsgbnZtIGluc3RhbGwgbm9kZSI8L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c3U8L3NwYW4+IGVjMi11c2VyIC1jIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPiJzb3VyY2UgL2hvbWUvZWMyLXVzZXIvLm52bS9udm0uc2ggJmFtcDsmYW1wOyBudm0gdXNlIG5vZGUiPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmxuPC9zcGFuPiAtcyAvaG9tZS9lYzItdXNlci8ubnZtL3ZlcnNpb25zL25vZGUvdjEwLjExLjAvYmluL25vZGUgL3Vzci9iaW4vbm9kZQo8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmxuPC9zcGFuPiAtcyAvaG9tZS9lYzItdXNlci8ubnZtL3ZlcnNpb25zL25vZGUvdjEwLjExLjAvYmluL25wbSAvdXNyL2Jpbi9ucG0KPHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5ta2Rpcjwvc3Bhbj4gLXAgL3Zhci93d3cKPHNwYW4gY2xhc3M9InRva2VuIGJ1aWx0aW4gY2xhc3MtbmFtZSI+ZWNobzwvc3Bhbj4gLWUgPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+InJlcXVpcmUoJ2h0dHAnKS5jcmVhdGVTZXJ2ZXIoKHJlcSwgcmVzKSA9PiB7Ijwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj4+PC9zcGFuPiAvdmFyL3d3dy9zZXJ2ZXIuanMKPHNwYW4gY2xhc3M9InRva2VuIGJ1aWx0aW4gY2xhc3MtbmFtZSI+ZWNobzwvc3Bhbj4gLWUgPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+IiAgcmVzLnNldEhlYWRlcignY29udGVudC10eXBlJywgJ3RleHQvcGxhaW4nKSI8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Pjwvc3Bhbj4gL3Zhci93d3cvc2VydmVyLmpzCjxzcGFuIGNsYXNzPSJ0b2tlbiBidWlsdGluIGNsYXNzLW5hbWUiPmVjaG88L3NwYW4+IC1lIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPiIgIHJlcy5lbmQoJ09LJykiPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj48L3NwYW4+IC92YXIvd3d3L3NlcnZlci5qcwo8c3BhbiBjbGFzcz0idG9rZW4gYnVpbHRpbiBjbGFzcy1uYW1lIj5lY2hvPC9zcGFuPiAtZSA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4ifSkubGlzdGVuKHByb2Nlc3MuZW52LlBPUlQgfHwgODApIjwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj4+PC9zcGFuPiAvdmFyL3d3dy9zZXJ2ZXIuanMKbm9kZSAvdmFyL3d3dy9zZXJ2ZXIuanM8L2NvZGU+PC9wcmU+CjxwPldlJ2xsIHN1cHBseSB0aGUgcGF0aCB0byB0aGUgdXNlci1kYXRhLnNoIHNjcmlwdCBhcyBhIHBhcmFtZXRlciB3aGVuIHdlIGNyZWF0ZSB0aGUgRUMyIGluc3RhbmNlIGxpa2Ugc286PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj5hd3MgZWMyIHJ1bi1pbnN0YW5jZXMgLS11c2VyLWRhdGEgZmlsZTovL3BhdGgvdG8veW91ci91c2VyLWRhdGEuc2g8L2NvZGU+PC9wcmU+CjxwPkhlcmUncyB3aGF0IGV2ZXJ5dGhpbmcgbG9va3MgbGlrZSB0b2dldGhlcjo8L3A+CjxzY3JpcHQgc3JjPSJodHRwczovL2dpc3QuZ2l0aHViLmNvbS91bnNoaWZ0L2U1NDY1MWJjMmMxYzk4NzQ5OTM1Y2Q2YmNkMGNjZDNjLmpzIj48L3NjcmlwdD4=","excerpt":"","image":{"id":"pum3dk2chwjxbistc2948swe2","url":"static/cjn3l18390lyt0158i8qxs5dc/aws.png"},"posts_tags":[{"tag":{"id":"3pl7ejawubufz70vjnad","name":"AWS"}}],"date":"10/11/2018","html":"<p>How do you run a web server on EC2?</p>\n<p>I've used AWS Lambda and/or Cloudformation extensively but was curious to see how difficult it is to spin up a EC2 instance and expose the right ports from the command line. Using AWS' command line interface This is a good approach for testing and playing with tools and has advantages over Cloudformation. Debugging Cloudformation can be a huge pain. Also creating and updating stacks can take a bit longer than simply running an instance from terminal.</p>\n<h2>Back to the Basics</h2>\n<h3>Perquisites</h3>\n<ul>\n  <li>I'll assume you've installed <strong>AWS CLI</strong>. If not, start <a href=\"https://docs.aws.amazon.com/cli/latest/userguide/installing.html\">here</a>. You can check by running <code>&nbsp;aws --version.</code></li>\n  <li>I'll be using <strong>jq</strong>, which is like sed for JSON data. Install it <a href=\"https://stedolan.github.io/jq/\">here</a>.</li>\n</ul>\n<p>What parameters do we need to run an instance? We need:</p>\n<ul>\n  <li>The Amazon Machine Image (AMI) ID.</li>\n  <li>Private Key Name</li>\n  <li>Subnet ID</li>\n  <li>Security Group IDs</li>\n  <li>User Data</li>\n</ul>\n<p>Before running any commands, export the AWS region you want to use so that you're not prompted for every command. I'll be using us-east-1.</p>\n<pre><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">AWS_DEFAULT_REGION</span><span class=\"token operator\">=</span>us-east-1</code></pre>\n<h3>Amazon Machine Image (AMI) ID</h3>\n<p>This identifies the instance on Amazon's marketplace. We'll stick with defaults and use the latest Amazon Linux Image.</p>\n<p>Run:</p>\n<pre><code class=\"language-bash\">aws ssm get-parameters --names /aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2 --query <span class=\"token string\">'Parameters[0].[Value]'</span> --output text</code></pre>\n<p>As of this writing, the latest Amazon Linux AMI is ami-0922553b7b0369273.</p>\n<h3>Private Key Name</h3>\n<p>When you create an EC2 instance on aws.amazon.com using the UI you're prompted to use an existing private key or create a new one. The private key is just the label associated with a set of public and private keys allowing SSH access to your instance.</p>\n<p>This command lists all of your existing key pairs:</p>\n<pre><code class=\"language-bash\">aws ec2 describe-key-pairs <span class=\"token operator\">|</span> jq -r <span class=\"token string\">'.KeyPairs'</span></code></pre>\n<p>If you don't have any keys, you can create a new one:</p>\n<pre><code class=\"language-bash\">aws ec2 create-key-pair --key-name webserver <span class=\"token operator\">|</span> jq -r <span class=\"token string\">'.KeyMaterial'</span> <span class=\"token operator\">></span> ~/.ssh/webserver.pem</code></pre>\n<p>This command saves the RSA key material to ~/.ssh/webserver.pem.</p>\n<h3>Subnet ID</h3>\n<p>AWS accounts have a default VPC, subnet, and set of security groups.</p>\n<p>Rather than create a new subnet we'll just use one of the subnets associated with the default VPC.</p>\n<p>Here's how you list subnets:</p>\n<pre><code class=\"language-bash\">aws ec2 describe-subnets <span class=\"token operator\">|</span> jq -r <span class=\"token string\">'.Subnets'</span></code></pre>\n<h3>Security Group IDs</h3>\n<p>For a web server, we'll use two security groups: a default security group associated with the default VPC, and a custom security group that exposes ports 22 (SSH), 80 (HTTP), and 443 (HTTPS).</p>\n<p>Get the default security group ID as follows:</p>\n<pre><code class=\"language-bash\">aws ec2 describe-security-groups --group-name default <span class=\"token operator\">|</span> jq -r <span class=\"token string\">'.SecurityGroups[0].GroupId'</span></code></pre>\n<p>And create a new security group:</p>\n<pre><code>aws ec2 create-security-group --group-name webserver --description webserver | jq -r '.GroupId'</code></pre>\n<p>Now we need to run authorize-security-group-ingress three times (once for each port).</p>\n<pre><code class=\"language-bash\">aws ec2 authorize-security-group-ingress --group-name webserver --protocol tcp --port <span class=\"token number\">22</span> --cidr <span class=\"token string\">'0.0.0.0/0'</span>\naws ec2 authorize-security-group-ingress --group-name webserver --protocol tcp --port <span class=\"token number\">80</span> --cidr <span class=\"token string\">'0.0.0.0/0'</span>\naws ec2 authorize-security-group-ingress --group-name webserver --protocol tcp --port <span class=\"token number\">443</span> --cidr <span class=\"token string\">'0.0.0.0/0'</span></code></pre>\n<p>We need to expose port 22 for SSH access, port 80 - the port that our node server will listen to, and port 443 for HTTPS.</p>\n<h2>User Data</h2>\n<p>User data lets us run scripts when the instance is launched. In this case, we need to install node and npm on the EC2 instance when it's created. Create a new file (e.g., user-data.sh) and add:</p>\n<pre><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash -v</span>\n<span class=\"token function\">su</span> ec2-user -c <span class=\"token string\">\"curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash\"</span>\n<span class=\"token function\">su</span> ec2-user -c <span class=\"token string\">\"source /home/ec2-user/.nvm/nvm.sh &amp;&amp; nvm install node\"</span>\n<span class=\"token function\">su</span> ec2-user -c <span class=\"token string\">\"source /home/ec2-user/.nvm/nvm.sh &amp;&amp; nvm use node\"</span>\n<span class=\"token function\">ln</span> -s /home/ec2-user/.nvm/versions/node/v10.11.0/bin/node /usr/bin/node\n<span class=\"token function\">ln</span> -s /home/ec2-user/.nvm/versions/node/v10.11.0/bin/npm /usr/bin/npm\n<span class=\"token function\">mkdir</span> -p /var/www\n<span class=\"token builtin class-name\">echo</span> -e <span class=\"token string\">\"require('http').createServer((req, res) => {\"</span> <span class=\"token operator\">></span> /var/www/server.js\n<span class=\"token builtin class-name\">echo</span> -e <span class=\"token string\">\"  res.setHeader('content-type', 'text/plain')\"</span> <span class=\"token operator\">></span> /var/www/server.js\n<span class=\"token builtin class-name\">echo</span> -e <span class=\"token string\">\"  res.end('OK')\"</span> <span class=\"token operator\">></span> /var/www/server.js\n<span class=\"token builtin class-name\">echo</span> -e <span class=\"token string\">\"}).listen(process.env.PORT || 80)\"</span> <span class=\"token operator\">></span> /var/www/server.js\nnode /var/www/server.js</code></pre>\n<p>We'll supply the path to the user-data.sh script as a parameter when we create the EC2 instance like so:</p>\n<pre><code class=\"language-bash\">aws ec2 run-instances --user-data file://path/to/your/user-data.sh</code></pre>\n<p>Here's what everything looks like together:</p>\n<script src=\"https://gist.github.com/unshift/e54651bc2c1c98749935cd6bcd0ccd3c.js\"></script>"}}}}