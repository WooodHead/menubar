{"componentChunkName":"component---src-components-post-tsx","path":"/configuring-vault-by-hashicorp-in-aws-ec2","result":{"pageContext":{"post":{"id":"d9920hsu8y7365frf2c6fxrx2","title":"Configuring Vault by Hashicorp in AWS EC2","slug":"configuring-vault-by-hashicorp-in-aws-ec2","published_at":"2019-04-15T02:34:51.791","created_at":"2019-04-14T02:02:41.144159","encoded_html":"PGgyPlZhdWx0IFF1aWNrIFN0YXJ0IGluIEVDMjwvaDI+CjxpbWcgc3JjPSJodHRwczovL3MzLmFtYXpvbmF3cy5jb20vY29udGVudGtpdC9zdGF0aWMvZDk5MjBoc3U4eTczNjVmcmYyYzZmeHJ4Mi9oYXNoaWNvcnAuanBnIiAvPgo8aDM+Q3JlYXRlIGFuIFMzIEJ1Y2tldCBmb3IgVmF1bHQ8L2gzPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj5hd3MgczMgY3JlYXRlLWJ1Y2tldCAtLWJ1Y2tldCBWQVVMVF9CVUNLRVRfTkFNRTwvY29kZT48L3ByZT4KPGgzPkNyZWF0ZSBhIFZhdWx0IElBTSBVc2VyPC9oMz4KPHA+Q3JlYXRlIHR3byBwb2xpY2llcyBhbmQgYXR0YWNoIHRoZW0gdG8gYSB1c2VyLCBWYXVsdC48L3A+CjxwPkFsbG93IGFjY2VzcyB0byB0aGUgbmV3bHkgY3JlYXRlZCBTMyBidWNrZXQ6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1qc29uIj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIHByb3BlcnR5Ij4iVmVyc2lvbiI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iMjAxMi0xMC0xNyI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogIDxzcGFuIGNsYXNzPSJ0b2tlbiBwcm9wZXJ0eSI+IlN0YXRlbWVudCI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPls8L3NwYW4+CiAgICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwcm9wZXJ0eSI+IkVmZmVjdCI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iQWxsb3ciPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgICAgPHNwYW4gY2xhc3M9InRva2VuIHByb3BlcnR5Ij4iQWN0aW9uIjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Wzwvc3Bhbj4KICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iczM6KiI8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+XTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwcm9wZXJ0eSI+IlJlc291cmNlIjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Wzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iYXJuOmF3czpzMzo6OlZBVUxUX0JVQ0tFVF9OQU1FLyoiPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+XTwvc3Bhbj4KICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPl08L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+fTwvc3Bhbj48L2NvZGU+PC9wcmU+CjxwPkFsbG93IElBTSBhY3Rpb25zIHJlcXVpcmVkIGJ5IFZhdWx0OiA8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWpzb24iPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+ezwvc3Bhbj4KICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwcm9wZXJ0eSI+IlZlcnNpb24iPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+IjIwMTItMTAtMTciPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwcm9wZXJ0eSI+IlN0YXRlbWVudCI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPls8L3NwYW4+CiAgICAgICAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gcHJvcGVydHkiPiJFZmZlY3QiPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+Ojwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+IkFsbG93Ijwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwcm9wZXJ0eSI+IkFjdGlvbiI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPls8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iaWFtOkF0dGFjaFVzZXJQb2xpY3kiPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPiJpYW06Q3JlYXRlQWNjZXNzS2V5Ijwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iaWFtOkNyZWF0ZVVzZXIiPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPiJpYW06RGVsZXRlQWNjZXNzS2V5Ijwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iaWFtOkRlbGV0ZVVzZXIiPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPiJpYW06RGVsZXRlVXNlclBvbGljeSI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+ImlhbTpEZXRhY2hVc2VyUG9saWN5Ijwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iaWFtOkxpc3RBY2Nlc3NLZXlzIjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iaWFtOkxpc3RBdHRhY2hlZFVzZXJQb2xpY2llcyI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+ImlhbTpMaXN0R3JvdXBzRm9yVXNlciI8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4sPC9zcGFuPgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+ImlhbTpMaXN0VXNlclBvbGljaWVzIjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4iaWFtOlB1dFVzZXJQb2xpY3kiPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPiJpYW06UmVtb3ZlVXNlckZyb21Hcm91cCI8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+XTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBwcm9wZXJ0eSI+IlJlc291cmNlIjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPjo8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Wzwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPiJhcm46YXdzOmlhbTo6e0FXU19BQ0NPVU5UX0lEfTp1c2VyL3ZhdWx0LSoiPC9zcGFuPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPl08L3NwYW4+CiAgICAgICAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPgogICAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj5dPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+PC9jb2RlPjwvcHJlPgo8aDM+Q3JlYXRlIGEgTmV3IFNlY3VyaXR5IEdyb3VwPC9oMz4KPHByZT48Y29kZSBjbGFzcz0ibGFuZ3VhZ2UtYmFzaCI+YXdzIGVjMiBjcmVhdGUtc2VjdXJpdHktZ3JvdXAgLS1ncm91cC1uYW1lIHZhdWx0LXNnIC0tZGVzY3JpcHRpb24gVmF1bHQgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj58PC9zcGFuPiBqcSAtciA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4nLkdyb3VwSWQnPC9zcGFuPjwvY29kZT48L3ByZT4KPGgzPkV4cG9zZSBQb3J0cyAyMiBhbmQgODIwMDwvaDM+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWJhc2giPmF3cyBlYzIgYXV0aG9yaXplLXNlY3VyaXR5LWdyb3VwLWluZ3Jlc3MgLS1ncm91cC1uYW1lIHZhdWx0LXNnIC0tcHJvdG9jb2wgdGNwIC0tcG9ydCA8c3BhbiBjbGFzcz0idG9rZW4gbnVtYmVyIj4yMjwvc3Bhbj4gLS1jaWRyIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPicwLjAuMC4wLzAnPC9zcGFuPgphd3MgZWMyIGF1dGhvcml6ZS1zZWN1cml0eS1ncm91cC1pbmdyZXNzIC0tZ3JvdXAtbmFtZSB2YXVsdC1zZyAtLXByb3RvY29sIHRjcCAtLXBvcnQgPHNwYW4gY2xhc3M9InRva2VuIG51bWJlciI+ODIwMDwvc3Bhbj4gLS1jaWRyIDxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPicwLjAuMC4wLzAnPC9zcGFuPjwvY29kZT48L3ByZT4KPGgzPkNyZWF0ZSBhbiBFQzIgSW5zdGFuY2U8L2gzPgo8cD5DcmVhdGUgYW4gRUMyIGluc3RhbmNlIHdpdGggdGhlIGxhdGVzdCBBTUksIHVzaW5nIHRoZSB2YXVsdC1zZyBzZWN1cml0eSBncm91cCBhbmQgdGhlIElBTSB1c2VyIGNyZWF0ZWQgYWJvdmUuPC9wPgo8cD5XYWl0IGEgbW9tZW50IGFuZCBTU0ggaW50byB0aGUgaW5zdGFuY2UsIHRoZW4gaW5zdGFsbCBWYXVsdCBhcyBmb2xsb3dzOjwvcD4KPHByZT48Y29kZSBjbGFzcz0ibGFuZ3VhZ2UtYmFzaCI+PHNwYW4gY2xhc3M9InRva2VuIGJ1aWx0aW4gY2xhc3MtbmFtZSI+Y2Q8L3NwYW4+IC90bXAgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj4mYW1wOyZhbXA7PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPndnZXQ8L3NwYW4+IGh0dHBzOi8vcmVsZWFzZXMuaGFzaGljb3JwLmNvbS92YXVsdC8xLjEuMS92YXVsdF8xLjEuMV9saW51eF9hbWQ2NC56aXAKPHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj51bnppcDwvc3Bhbj4gdmF1bHRfMS4xLjFfbGludXhfYW1kNjQuemlwCjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+Y3A8L3NwYW4+IHZhdWx0IC91c3IvYmluL3ZhdWx0CnZhdWx0IC0tdmVyc2lvbjwvY29kZT48L3ByZT4KPHA+TWFrZSBhIFZhdWx0IGRhdGEgZGlyZWN0b3J5OjwvcD4KPHByZT48Y29kZSBjbGFzcz0ibGFuZ3VhZ2UtYmFzaCI+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5ta2Rpcjwvc3Bhbj4gLXAgL2V0Yy92YXVsdC5kPC9jb2RlPjwvcHJlPgo8cD5Db25maWd1cmUgVmF1bHQ6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnRvdWNoPC9zcGFuPiAvZXRjL3ZhdWx0LmQvdmF1bHQuaGNsPC9jb2RlPjwvcHJlPgo8cD5BZGQgdGhlIGZvbGxvd2luZyBjb25maWd1cmF0aW9uIHRvIHZhdWx0LmhjbDo8L3A+CjxwcmU+PGNvZGU+dWkgPSB0cnVlCmxpc3RlbmVyICJ0Y3AiIHsKICBhZGRyZXNzID0gIjAuMC4wLjA6ODIwMCIKfQpiYWNrZW5kICJzMyIgewogIGJ1Y2tldCA9ICJZT1VSX0FXU19CVUNLRVQiCiAgcmVnaW9uID0gInVzLWVhc3QtMSIKfTwvY29kZT48L3ByZT4KPHA+QWRkIHN5c3RlbWQgc2VydmljZSBmaWxlIGZvciBWYXVsdDo8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWJhc2giPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Wzwvc3Bhbj5Vbml0PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj5dPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gYXNzaWduLWxlZnQgdmFyaWFibGUiPkRlc2NyaXB0aW9uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj5WYXVsdAo8c3BhbiBjbGFzcz0idG9rZW4gYXNzaWduLWxlZnQgdmFyaWFibGUiPlJlcXVpcmVzPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj5uZXR3b3JrLW9ubGluZS50YXJnZXQKPHNwYW4gY2xhc3M9InRva2VuIGFzc2lnbi1sZWZ0IHZhcmlhYmxlIj5BZnRlcjwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+bmV0d29yay1vbmxpbmUudGFyZ2V0CjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Wzwvc3Bhbj5TZXJ2aWNlPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj5dPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gYXNzaWduLWxlZnQgdmFyaWFibGUiPlJlc3RhcnQ8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPm9uLWZhaWx1cmUKPHNwYW4gY2xhc3M9InRva2VuIGFzc2lnbi1sZWZ0IHZhcmlhYmxlIj5FeGVjU3RhcnQ8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPi91c3IvYmluL3ZhdWx0IHNlcnZlciAtY29uZmlnIC9ldGMvdmF1bHQuZC92YXVsdC5oY2wKPHNwYW4gY2xhc3M9InRva2VuIGFzc2lnbi1sZWZ0IHZhcmlhYmxlIj5FeGVjUmVsb2FkPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4vYmluL2tpbGwgLUhVUCA8c3BhbiBjbGFzcz0idG9rZW4gdmFyaWFibGUiPiRNQUlOUElEPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gYXNzaWduLWxlZnQgdmFyaWFibGUiPktpbGxTaWduYWw8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPlNJR1RFUk0KPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj5bPC9zcGFuPkluc3RhbGw8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPl08L3NwYW4+CjxzcGFuIGNsYXNzPSJ0b2tlbiBhc3NpZ24tbGVmdCB2YXJpYWJsZSI+V2FudGVkQnk8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPm11bHRpLXVzZXIudGFyZ2V0PC9jb2RlPjwvcHJlPgo8cD5TdGFydCBWYXVsdDo8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWJhc2giPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c2VydmljZTwvc3Bhbj4gdmF1bHQgc3RhcnQ8L2NvZGU+PC9wcmU+CjxwPkZpbmQgdGhlIHB1YmxpYyBETlMgYXNzb2NpYXRlZCB3aXRoIHlvdXIgRUMyIGluc3RhbmNlIGFuZCB2aXNpdCB0aGUgdXJsIG9uIHBvcnQgODIwMDo8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWJhc2giPmh0dHBzOi8vZWMyLXh4LXh4LXh4LXh4LmNvbXB1dGUtMS5hbWF6b25hd3MuY29tOjgyMDA8L2NvZGU+PC9wcmU+","excerpt":"How to configure Vault on EC2.","image":{"id":"o7jcwfh0wu780bnyrig7yn257","url":"static/d9920hsu8y7365frf2c6fxrx2/vault.png"},"posts_tags":[{"tag":{"id":"3pl7ejawubufz70vjnad","name":"AWS"}},{"tag":{"id":"782rutu758gkyzbpqx1i","name":"Hashicorp"}}],"date":"04/15/2019","html":"<h2>Vault Quick Start in EC2</h2>\n<img src=\"https://s3.amazonaws.com/contentkit/static/d9920hsu8y7365frf2c6fxrx2/hashicorp.jpg\" />\n<h3>Create an S3 Bucket for Vault</h3>\n<pre><code class=\"language-bash\">aws s3 create-bucket --bucket VAULT_BUCKET_NAME</code></pre>\n<h3>Create a Vault IAM User</h3>\n<p>Create two policies and attach them to a user, Vault.</p>\n<p>Allow access to the newly created S3 bucket:</p>\n<pre><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"Version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"Statement\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"Effect\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Action\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"s3:*\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"Resource\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"arn:aws:s3:::VAULT_BUCKET_NAME/*\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Allow IAM actions required by Vault: </p>\n<pre><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"Version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"Statement\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"Effect\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Allow\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"Action\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string\">\"iam:AttachUserPolicy\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:CreateAccessKey\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:CreateUser\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:DeleteAccessKey\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:DeleteUser\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:DeleteUserPolicy\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:DetachUserPolicy\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:ListAccessKeys\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:ListAttachedUserPolicies\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:ListGroupsForUser\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:ListUserPolicies\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:PutUserPolicy\"</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"iam:RemoveUserFromGroup\"</span>\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"Resource\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string\">\"arn:aws:iam::{AWS_ACCOUNT_ID}:user/vault-*\"</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h3>Create a New Security Group</h3>\n<pre><code class=\"language-bash\">aws ec2 create-security-group --group-name vault-sg --description Vault <span class=\"token operator\">|</span> jq -r <span class=\"token string\">'.GroupId'</span></code></pre>\n<h3>Expose Ports 22 and 8200</h3>\n<pre><code class=\"language-bash\">aws ec2 authorize-security-group-ingress --group-name vault-sg --protocol tcp --port <span class=\"token number\">22</span> --cidr <span class=\"token string\">'0.0.0.0/0'</span>\naws ec2 authorize-security-group-ingress --group-name vault-sg --protocol tcp --port <span class=\"token number\">8200</span> --cidr <span class=\"token string\">'0.0.0.0/0'</span></code></pre>\n<h3>Create an EC2 Instance</h3>\n<p>Create an EC2 instance with the latest AMI, using the vault-sg security group and the IAM user created above.</p>\n<p>Wait a moment and SSH into the instance, then install Vault as follows:</p>\n<pre><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> /tmp <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">wget</span> https://releases.hashicorp.com/vault/1.1.1/vault_1.1.1_linux_amd64.zip\n<span class=\"token function\">unzip</span> vault_1.1.1_linux_amd64.zip\n<span class=\"token function\">cp</span> vault /usr/bin/vault\nvault --version</code></pre>\n<p>Make a Vault data directory:</p>\n<pre><code class=\"language-bash\"><span class=\"token function\">mkdir</span> -p /etc/vault.d</code></pre>\n<p>Configure Vault:</p>\n<pre><code class=\"language-bash\"><span class=\"token function\">touch</span> /etc/vault.d/vault.hcl</code></pre>\n<p>Add the following configuration to vault.hcl:</p>\n<pre><code>ui = true\nlistener \"tcp\" {\n  address = \"0.0.0.0:8200\"\n}\nbackend \"s3\" {\n  bucket = \"YOUR_AWS_BUCKET\"\n  region = \"us-east-1\"\n}</code></pre>\n<p>Add systemd service file for Vault:</p>\n<pre><code class=\"language-bash\"><span class=\"token punctuation\">[</span>Unit<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">Description</span><span class=\"token operator\">=</span>Vault\n<span class=\"token assign-left variable\">Requires</span><span class=\"token operator\">=</span>network-online.target\n<span class=\"token assign-left variable\">After</span><span class=\"token operator\">=</span>network-online.target\n<span class=\"token punctuation\">[</span>Service<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">Restart</span><span class=\"token operator\">=</span>on-failure\n<span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/bin/vault server -config /etc/vault.d/vault.hcl\n<span class=\"token assign-left variable\">ExecReload</span><span class=\"token operator\">=</span>/bin/kill -HUP <span class=\"token variable\">$MAINPID</span>\n<span class=\"token assign-left variable\">KillSignal</span><span class=\"token operator\">=</span>SIGTERM\n<span class=\"token punctuation\">[</span>Install<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">WantedBy</span><span class=\"token operator\">=</span>multi-user.target</code></pre>\n<p>Start Vault:</p>\n<pre><code class=\"language-bash\"><span class=\"token function\">service</span> vault start</code></pre>\n<p>Find the public DNS associated with your EC2 instance and visit the url on port 8200:</p>\n<pre><code class=\"language-bash\">https://ec2-xx-xx-xx-xx.compute-1.amazonaws.com:8200</code></pre>"}}}}