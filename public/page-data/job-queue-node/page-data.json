{"componentChunkName":"component---src-components-post-tsx","path":"/job-queue-node","result":{"pageContext":{"post":{"id":"cjeqgfvhunmy90167t6ouqfmb","title":"Setting Up A Job Queue For A Node App [Tutorial]","slug":"job-queue-node","published_at":null,"created_at":"2018-03-14T02:16:45","encoded_html":"PHA+IE1hbnkgd2ViIGFwcHMgd2lsbCBuZWVkIGEgam9iIHF1ZXVlIGF0IHNvbWUgcG9pbnQgaW4gdGhlaXIgZGV2ZWxvcG1lbnQuPC9wPgo8cD5BIGpvYiBxdWV1ZSBlbmFibGVzIHlvdSB0byB1bmNvdXBsZSBsb25nLXJ1bm5pbmcgb3IgcmVzb3VyY2UtaW50ZW5zaXZlIHRhc2tzIGZyb20gdGhlIHJlcXVlc3QvcmVzcG9uc2UgbGlmZWN5Y2xlLjwvcD4KPHA+Q3JlYXRpbmcgUERGcywgc2VuZGluZyBlbWFpbHMsIGFuZCBwcm9jZXNzaW5nIGF1ZGlvIG9yIHZpZGVvIGFyZSB0YXNrcyB0aGF0IGFyZSBiZXN0IGhhbmRsZWQgYnkgYSBqb2IgcXVldWUuIEEgcXVldWUgYWxzbyBlbmFibGVzIHlvdSB0byBiYWxhbmNlIGxvYWQgYW5kIHRyaWFnZSB0YXNrcy48L3A+CjxwPk9uZSBvZiB0aGUgYmVzdCBqb2IgcXVldWUgc29sdXRpb25zIGZvciBOb2RlIGlzIGt1ZSBieSBBdXRvbWF0dGljLjwvcD4KPHA+V2l0aCBLdWUsIHlvdSBjYW4gcXVpY2tseSBkZXBsb3kgYSBqb2IgcXVldWUgbWljcm9zZXJ2aWNlIHdpdGggYSByZXN0IEFQSSBhbmQgc2ltcGxlIFVJLjwvcD4KPGZpZ3VyZT48aW1nIHNyYz0iaHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tL2NvbnRlbnRraXQtZGV2LWRlcGxveW1lbnRidWNrZXQtM2hsY2JxeDlmOW5sL3N0YXRpYy9jamVxZ2Z2aHVubXk5MDE2N3Q2b3VxZm1iL2t1ZS5wbmciLz48L2ZpZ3VyZT4KPGgyPkhvdyBLdWUgV29ya3M8L2gyPgo8cD5LdWUgdXNlcyBSZWRpcyBhcyBhIGRhdGFiYXNlIHRvIHN0b3JlIGpvYnMgYWxvbmcgd2l0aCBOb2RlJ3MgYnVpbHQtaW4gZXZlbnQgZW1pdHRlcnMuPC9wPgo8cD5TdGFydGluZyBmcm9tIHNjcmF0Y2g6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1iYXNoIj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPm1rZGlyPC9zcGFuPiBqb2JzLXF1ZXVlIDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+JmFtcDsmYW1wOzwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIGJ1aWx0aW4gY2xhc3MtbmFtZSI+Y2Q8L3NwYW4+IGpvYnMtcXVldWUKPHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj50b3VjaDwvc3Bhbj4gaW5kZXguanMKPHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5ucG08L3NwYW4+IGluaXQ8L2NvZGU+PC9wcmU+CjxwPkluc3RhbGwga3VlOjwvcD4KPHByZT48Y29kZSBjbGFzcz0ibGFuZ3VhZ2UtYmFzaCI+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5ucG08L3NwYW4+IGkga3VlIC0tc2F2ZTwvY29kZT48L3ByZT4KPHA+SW4gaW5kZXguanM6PC9wPgo8cHJlPjxjb2RlIGNsYXNzPSJsYW5ndWFnZS1qcyI+PHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmNvbnN0PC9zcGFuPiBrdWUgPHNwYW4gY2xhc3M9InRva2VuIG9wZXJhdG9yIj49PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnJlcXVpcmU8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidrdWUnPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIGtleXdvcmQiPmNvbnN0PC9zcGFuPiBxdWV1ZSA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj08L3NwYW4+IGt1ZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmNyZWF0ZVF1ZXVlPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+CiAgcmVkaXM8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPjo8L3NwYW4+IHByb2Nlc3M8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+ZW52PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBjb25zdGFudCI+UkVESVNfVVJMPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPn08L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+dmFyPC9zcGFuPiBkYXRhIDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj57PC9zcGFuPgogIHRpdGxlPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj46PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gc3RyaW5nIj4nbXktam9iJzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+CiAgbWVzc2FnZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ojwvc3Bhbj4gPHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+J2xvcmVtIGlwc3VtJzwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPgo8c3BhbiBjbGFzcz0idG9rZW4ga2V5d29yZCI+dmFyPC9zcGFuPiB0YXNrIDxzcGFuIGNsYXNzPSJ0b2tlbiBvcGVyYXRvciI+PTwvc3Bhbj4gcXVldWU8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIGZ1bmN0aW9uIj5jcmVhdGU8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPid0YXNrJzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IGRhdGE8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+ZGVsYXk8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBudW1iZXIiPjYwPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPio8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBudW1iZXIiPjEwMDA8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gY29tbWVudCI+Ly8gMSBtaW51dGU8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+cHJpb3JpdHk8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPidoaWdoJzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPik8L3NwYW4+CiAgPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBmdW5jdGlvbiI+c2F2ZTwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPgpxdWV1ZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPnByb2Nlc3M8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBzdHJpbmciPid0YXNrJzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KDwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcGFyYW1ldGVyIj5qb2I8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPiw8L3NwYW4+IGRvbmU8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4pPC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gb3BlcmF0b3IiPj0+PC9zcGFuPiA8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPns8L3NwYW4+CiAgY29uc29sZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+Ljwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmxvZzwvc3Bhbj48c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPig8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHN0cmluZyI+Im1lc3NhZ2UiPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+LDwvc3Bhbj4gam9iPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4uPC9zcGFuPmRhdGE8c3BhbiBjbGFzcz0idG9rZW4gcHVuY3R1YXRpb24iPi48L3NwYW4+bWVzc2FnZTxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KICA8c3BhbiBjbGFzcz0idG9rZW4gZnVuY3Rpb24iPmRvbmU8L3NwYW4+PHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj4oPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj4KPHNwYW4gY2xhc3M9InRva2VuIHB1bmN0dWF0aW9uIj59PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b2tlbiBwdW5jdHVhdGlvbiI+KTwvc3Bhbj48L2NvZGU+PC9wcmU+","excerpt":" Many web apps will need a job queue at some point in their development.","image":null,"posts_tags":[],"date":"03/14/2018","html":"<p> Many web apps will need a job queue at some point in their development.</p>\n<p>A job queue enables you to uncouple long-running or resource-intensive tasks from the request/response lifecycle.</p>\n<p>Creating PDFs, sending emails, and processing audio or video are tasks that are best handled by a job queue. A queue also enables you to balance load and triage tasks.</p>\n<p>One of the best job queue solutions for Node is kue by Automattic.</p>\n<p>With Kue, you can quickly deploy a job queue microservice with a rest API and simple UI.</p>\n<figure><img src=\"https://s3.amazonaws.com/contentkit-dev-deploymentbucket-3hlcbqx9f9nl/static/cjeqgfvhunmy90167t6ouqfmb/kue.png\"/></figure>\n<h2>How Kue Works</h2>\n<p>Kue uses Redis as a database to store jobs along with Node's built-in event emitters.</p>\n<p>Starting from scratch:</p>\n<pre><code class=\"language-bash\"><span class=\"token function\">mkdir</span> jobs-queue <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> jobs-queue\n<span class=\"token function\">touch</span> index.js\n<span class=\"token function\">npm</span> init</code></pre>\n<p>Install kue:</p>\n<pre><code class=\"language-bash\"><span class=\"token function\">npm</span> i kue --save</code></pre>\n<p>In index.js:</p>\n<pre><code class=\"language-js\"><span class=\"token keyword\">const</span> kue <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kue'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> queue <span class=\"token operator\">=</span> kue<span class=\"token punctuation\">.</span><span class=\"token function\">createQueue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  redis<span class=\"token punctuation\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">REDIS_URL</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  title<span class=\"token punctuation\">:</span> <span class=\"token string\">'my-job'</span><span class=\"token punctuation\">,</span>\n  message<span class=\"token punctuation\">:</span> <span class=\"token string\">'lorem ipsum'</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> task <span class=\"token operator\">=</span> queue<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token string\">'task'</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 1 minute</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">priority</span><span class=\"token punctuation\">(</span><span class=\"token string\">'high'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nqueue<span class=\"token punctuation\">.</span><span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token string\">'task'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">job<span class=\"token punctuation\">,</span> done</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"message\"</span><span class=\"token punctuation\">,</span> job<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span>\n  <span class=\"token function\">done</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre>"}}}}